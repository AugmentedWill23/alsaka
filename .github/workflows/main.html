<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Case Spinner Game</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      color: #ffffff;
      overflow-x: hidden;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0, 0, 0, 0.4);
      padding: 20px 30px;
      border-radius: 20px;
      margin-bottom: 25px;
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .logo {
      font-size: 32px;
      font-weight: bold;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 4s ease-in-out infinite;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .stats {
      display: flex;
      gap: 30px;
      align-items: center;
    }

    .stat {
      text-align: center;
    }

    .stat-label {
      font-size: 12px;
      opacity: 0.7;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 18px;
      font-weight: bold;
    }

    .premium-badge {
      background: linear-gradient(45deg, #ffd700, #ffed4e);
      color: #000;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    .main-nav {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .nav-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
      flex: 1;
      min-width: 120px;
    }

    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .nav-btn.active {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
    }

    .screen {
      display: none;
      animation: fadeIn 0.3s ease-in-out;
    }

    .screen.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .case-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .case-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      backdrop-filter: blur(10px);
    }

    .case-card:hover {
      transform: translateY(-5px);
      border-color: #4ecdc4;
      box-shadow: 0 15px 35px rgba(78, 205, 196, 0.3);
    }

    .case-image {
      width: 120px;
      height: 120px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      border-radius: 15px;
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
    }

    .case-name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .case-price {
      color: #4ecdc4;
      font-size: 16px;
      font-weight: bold;
    }

    .spinner-container {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 20px;
      padding: 40px;
      text-align: center;
      margin: 20px 0;
    }

    .spinner-wheel {
      width: 400px;
      height: 400px;
      border: 8px solid #333;
      border-radius: 50%;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
      background: conic-gradient(
        #ffffff 0deg 45deg,
        #3498db 45deg 90deg,
        #9b59b6 90deg 135deg,
        #e91e63 135deg 180deg,
        #f44336 180deg 225deg,
        #ff9800 225deg 270deg,
        #ffd700 270deg 315deg,
        #000000 315deg 360deg
      );
      box-shadow: 0 0 50px rgba(78, 205, 196, 0.5);
    }

    .spinner-items {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }

    .spinner-item {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      border: 2px solid #fff;
      transform-origin: 200px 200px;
    }

    .spinner-highlight {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      border: 4px solid #ffd700;
      border-radius: 50%;
      z-index: 10;
      animation: highlight 1s ease-in-out infinite;
    }

    @keyframes highlight {
      0%, 100% { box-shadow: 0 0 20px #ffd700; }
      50% { box-shadow: 0 0 40px #ffd700, 0 0 60px #ffed4e; }
    }

    .spinner-pointer {
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-top: 30px solid #ff6b6b;
      z-index: 10;
    }

    .spin-btn {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
      border: none;
      color: white;
      padding: 20px 40px;
      border-radius: 15px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 30px;
      transition: all 0.3s ease;
    }

    .spin-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
    }

    .spin-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .inventory-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      max-height: 600px;
      overflow-y: auto;
      padding: 20px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px;
    }

    .skin-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .skin-item:hover {
      transform: translateY(-3px);
      border-color: #4ecdc4;
    }

    .skin-icon {
      width: 80px;
      height: 80px;
      border-radius: 10px;
      margin: 0 auto 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .rarity-white { background: linear-gradient(45deg, #ffffff, #f8f9fa); color: #333; }
    .rarity-blue { background: linear-gradient(45deg, #3498db, #2980b9); }
    .rarity-purple { background: linear-gradient(45deg, #9b59b6, #8e44ad); }
    .rarity-pink { background: linear-gradient(45deg, #e91e63, #c2185b); }
    .rarity-red { background: linear-gradient(45deg, #f44336, #d32f2f); }
    .rarity-yellow { background: linear-gradient(45deg, #ff9800, #f57c00); }
    .rarity-golden { background: linear-gradient(45deg, #ffd700, #ffb300); }
    .rarity-black { background: linear-gradient(45deg, #000000, #424242); }
    .rarity-volcanic { 
      background: linear-gradient(45deg, #ff4500, #8b0000, #ff6347); 
      animation: volcanic 2s ease-in-out infinite; 
      box-shadow: 0 0 20px #ff4500;
    }
    .rarity-obsidian { 
      background: linear-gradient(45deg, #2f2f2f, #000000, #4a4a4a); 
      animation: obsidianPulse 3s ease-in-out infinite; 
      box-shadow: 0 0 15px #000000;
    }
    .rarity-shattered { 
      background: linear-gradient(45deg, #1a1a1a, #333333, #666666); 
      animation: shatter 1.5s ease-in-out infinite; 
      box-shadow: 0 0 10px #333333;
    }

    @keyframes volcanic {
      0%, 100% { box-shadow: 0 0 20px #ff4500; }
      50% { box-shadow: 0 0 40px #ff6347, 0 0 60px #ff4500; }
    }

    @keyframes obsidianPulse {
      0%, 100% { box-shadow: 0 0 15px #000000; }
      50% { box-shadow: 0 0 30px #4a4a4a, 0 0 45px #2f2f2f; }
    }

    @keyframes shatter {
      0%, 100% { transform: scale(1); box-shadow: 0 0 10px #333333; }
      50% { transform: scale(1.05); box-shadow: 0 0 25px #666666; }
    }

    .daily-reward-day {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .daily-reward-day.claimed {
      border-color: #4ecdc4;
      background: rgba(78, 205, 196, 0.2);
    }

    .daily-reward-day.current {
      border-color: #ff6b6b;
      background: rgba(255, 107, 107, 0.2);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .event-timer {
      background: linear-gradient(45deg, #ff6b6b, #ee5a24);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      margin-top: 10px;
      display: inline-block;
    }

    .market-tab {
      animation: fadeIn 0.3s ease-in-out;
    }

    .theme-selector {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 15px;
      padding: 15px;
      z-index: 1000;
    }

    .theme-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      margin: 2px;
      transition: all 0.3s ease;
    }

    .theme-btn.active {
      background: #4ecdc4;
    }

    .battle-participant {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      margin: 10px;
      text-align: center;
      border: 2px solid transparent;
    }

    .battle-participant.winner {
      border-color: #ffd700;
      background: rgba(255, 215, 0, 0.2);
    }

    .battle-participant.loser {
      border-color: #ff6b6b;
      background: rgba(255, 107, 107, 0.1);
    }

    .exp-bar {
      width: 100%;
      height: 12px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      overflow: hidden;
      margin: 10px 0;
    }

    .exp-progress {
      height: 100%;
      background: linear-gradient(90deg, #4ecdc4, #44a08d);
      border-radius: 6px;
      transition: width 0.5s ease;
    }

    .clan-bank {
      background: rgba(255, 215, 0, 0.1);
      border: 2px solid #ffd700;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
    }

    .trade-window {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border-radius: 20px;
      padding: 30px;
      z-index: 1500;
      border: 2px solid #4ecdc4;
      display: none;
    }

    .skin-name {
      font-size: 12px;
      margin-bottom: 5px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .skin-value {
      font-size: 14px;
      font-weight: bold;
      color: #4ecdc4;
    }

    .marketplace-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .marketplace-item .skin-icon {
      margin: 0;
    }

    .item-info {
      flex: 1;
    }

    .item-name {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .item-price {
      color: #4ecdc4;
      font-size: 18px;
      font-weight: bold;
    }

    .buy-btn {
      background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .buy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
    }

    .battle-arena {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 20px;
      padding: 30px;
      margin: 20px 0;
    }

    .battle-opponents {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .opponent-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
    }

    .opponent-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(45deg, #667eea, #764ba2);
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
    }

    .quest-list {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px;
      padding: 20px;
      max-height: 500px;
      overflow-y: auto;
    }

    .quest-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .quest-progress {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      margin: 10px 0;
      overflow: hidden;
    }

    .quest-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #4ecdc4, #44a08d);
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .clan-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      margin-bottom: 20px;
    }

    .clan-banner {
      width: 100px;
      height: 100px;
      border-radius: 15px;
      background: linear-gradient(45deg, #ff6b6b, #ee5a24);
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
    }

    .leaderboard-table {
      width: 100%;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px;
      overflow: hidden;
    }

    .leaderboard-table th,
    .leaderboard-table td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .leaderboard-table th {
      background: rgba(0, 0, 0, 0.3);
      font-weight: bold;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      border: 2px solid #4ecdc4;
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 20px;
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }

    .reward-animation {
      animation: rewardPulse 2s ease-in-out;
    }

    @keyframes rewardPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .particle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #ffd700;
      border-radius: 50%;
      pointer-events: none;
      animation: particle 2s ease-out forwards;
    }

    @keyframes particle {
      0% {
        opacity: 1;
        transform: scale(1);
      }
      100% {
        opacity: 0;
        transform: scale(0) translateY(-100px);
      }
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      z-index: 1001;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }

    .filters {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filter-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid transparent;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-btn.active {
      border-color: #4ecdc4;
      background: rgba(78, 205, 196, 0.2);
    }

    .afk-timer {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      text-align: center;
    }

    .timer-display {
      font-size: 24px;
      font-weight: bold;
      color: #4ecdc4;
      margin-bottom: 10px;
    }

    .daily-reward-day {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .daily-reward-day.claimed {
      border-color: #4ecdc4;
      background: rgba(78, 205, 196, 0.2);
    }

    .daily-reward-day.current {
      border-color: #ff6b6b;
      background: rgba(255, 107, 107, 0.2);
    }

    .fusion-slot {
      width: 80px;
      height: 80px;
      border: 3px dashed rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .fusion-slot.filled {
      border-style: solid;
      border-color: #4ecdc4;
      background: rgba(78, 205, 196, 0.2);
    }

    .fusion-slot:hover {
      border-color: #ff6b6b;
    }

    .achievement-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-left: 4px solid transparent;
    }

    .achievement-item.completed {
      border-left-color: #4ecdc4;
      background: rgba(78, 205, 196, 0.1);
    }

    .achievement-item.claimed {
      opacity: 0.6;
      border-left-color: #666;
    }

    .event-timer {
      background: linear-gradient(45deg, #ff6b6b, #ee5a24);
      color: white;
      padding: 5px 10px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: bold;
      margin-top: 5px;
    }

    .pity-counter {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 12px;
      margin-top: 5px;
    }

    .rarity-event { 
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #ffd700, #9b59b6); 
      background-size: 400% 400%;
      animation: rainbowShift 3s ease-in-out infinite;
    }

    @keyframes rainbowShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .sound-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: white;
      padding: 10px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      z-index: 1000;
    }

    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .header {
        flex-direction: column;
        gap: 15px;
      }
      
      .stats {
        gap: 15px;
        flex-wrap: wrap;
      }
      
      .spinner-wheel {
        width: 300px;
        height: 300px;
      }
      
      .case-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }
      
      .inventory-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }

      .main-nav {
        gap: 8px;
      }

      .nav-btn {
        padding: 12px 15px;
        font-size: 14px;
        min-width: 100px;
      }
    }
  </style>
</head>
<body>
  <button class="sound-toggle" onclick="toggleSound()" id="sound-toggle">üîä</button>
  
  <div class="theme-selector">
    <div style="font-size: 12px; margin-bottom: 10px; color: white;">Themes:</div>
    <button class="theme-btn active" onclick="setTheme('dark')" id="theme-dark">Dark</button>
    <button class="theme-btn" onclick="setTheme('neon')" id="theme-neon">Neon</button>
    <button class="theme-btn" onclick="setTheme('cs2')" id="theme-cs2">CS2</button>
    <button class="theme-btn" onclick="setTheme('light')" id="theme-light">Light</button>
  </div>

  <div class="container">
    <header class="header">
      <div class="logo">üé∞ Case Spinner Pro</div>
      <div class="stats">
        <div class="stat">
          <div class="stat-label">Balance</div>
          <div class="stat-value" id="balance">$5,000</div>
        </div>
        <div class="stat">
          <div class="stat-label">Net Worth</div>
          <div class="stat-value" id="networth">$5,000</div>
        </div>
        <div class="stat">
          <div class="stat-label">Luck Tokens</div>
          <div class="stat-value" id="tokens">3</div>
        </div>
        <div class="stat">
          <div class="stat-label">Vault Keys</div>
          <div class="stat-value" id="vault-keys">0</div>
        </div>
        <div class="stat">
          <div class="stat-label">Fragments</div>
          <div class="stat-value" id="fragments">0</div>
        </div>
        <div class="stat">
          <div class="stat-label">Rank</div>
          <div class="stat-value" id="rank" style="color: #CD7F32;">Bronze</div>
        </div>
        <div class="premium-badge" id="premium-status">Premium</div>
      </div>
    </header>

    <nav class="main-nav">
      <button class="nav-btn active" onclick="showScreen('cases')">Cases</button>
      <button class="nav-btn" onclick="showScreen('inventory')">Inventory</button>
      <button class="nav-btn" onclick="showScreen('marketplace')">Marketplace</button>
      <button class="nav-btn" onclick="showScreen('battles')">Battles</button>
      <button class="nav-btn" onclick="showScreen('premium')">Premium</button>
      <button class="nav-btn" onclick="showScreen('vault')">Obsidian Vault</button>
      <button class="nav-btn" onclick="showScreen('quests')">Quests</button>
      <button class="nav-btn" onclick="showScreen('achievements')">Achievements</button>
      <button class="nav-btn" onclick="showScreen('fusion')">Fusion</button>
      <button class="nav-btn" onclick="showScreen('dailyrewards')">Daily</button>
      <button class="nav-btn" onclick="showScreen('clans')">Clans</button>
      <button class="nav-btn" onclick="showScreen('leaderboards')">Rankings</button>
    </nav>

    <!-- Cases Screen -->
    <div id="cases" class="screen active">
      <div class="afk-timer">
        <div class="timer-display" id="afk-timer">29:45</div>
        <div>Next AFK reward in</div>
        <button class="buy-btn" onclick="claimAFK()" id="claim-afk" style="display:none;">Claim $1</button>
      </div>

      <div class="case-grid" id="case-grid">
        <!-- Cases will be generated by JavaScript -->
      </div>
    </div>

    <!-- Inventory Screen -->
    <div id="inventory" class="screen">
      <div class="filters">
        <button class="filter-btn active" onclick="filterInventory('all')">All</button>
        <button class="filter-btn" onclick="filterInventory('white')">White</button>
        <button class="filter-btn" onclick="filterInventory('blue')">Blue</button>
        <button class="filter-btn" onclick="filterInventory('purple')">Purple</button>
        <button class="filter-btn" onclick="filterInventory('pink')">Pink</button>
        <button class="filter-btn" onclick="filterInventory('red')">Red</button>
        <button class="filter-btn" onclick="filterInventory('yellow')">Yellow</button>
        <button class="filter-btn" onclick="filterInventory('golden')">Golden</button>
        <button class="filter-btn" onclick="filterInventory('black')">Black</button>
      </div>
      <div class="inventory-grid" id="inventory-grid">
        <!-- Inventory items will be generated by JavaScript -->
      </div>
    </div>

    <!-- Marketplace Screen -->
    <div id="marketplace" class="screen">
      <h2 style="margin-bottom: 20px;">üè™ Marketplace</h2>
      <div style="display: flex; gap: 20px; margin-bottom: 20px;">
        <button class="nav-btn active" onclick="showMarketTab('buy')" id="market-buy">Buy Skins</button>
        <button class="nav-btn" onclick="showMarketTab('sell')" id="market-sell">Sell Skins</button>
        <button class="nav-btn" onclick="showMarketTab('vault')" id="market-vault">Vault Cases</button>
      </div>
      
      <div id="marketplace-buy" class="market-tab">
        <div id="marketplace-listings">
          <!-- Buy listings will be generated by JavaScript -->
        </div>
      </div>
      
      <div id="marketplace-sell" class="market-tab" style="display: none;">
        <h3>List Your Skins for Sale</h3>
        <div id="sellable-inventory" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; margin: 20px 0;">
          <!-- Sellable inventory will be generated here -->
        </div>
      </div>
      
      <div id="marketplace-vault" class="market-tab" style="display: none;">
        <div style="background: rgba(139, 69, 19, 0.3); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
          <h3 style="color: #ffd700;">‚ö†Ô∏è EXTREME PRICES WARNING ‚ö†Ô∏è</h3>
          <p>Vault cases available at astronomical prices with slightly better odds.</p>
          <p>Recommended: Exchange <strong>500 Luck Tokens for 1 Vault Key</strong> instead.</p>
        </div>
        <div id="vault-marketplace-listings">
          <!-- Vault cases will be listed here -->
        </div>
      </div>
    </div>

    <!-- Battles Screen -->
    <div id="battles" class="screen">
      <div class="battle-arena">
        <h2 style="margin-bottom: 20px;">‚öîÔ∏è Case Battles</h2>
        <div style="margin-bottom: 20px;">
          <h3>Select Battle Case:</h3>
          <select id="battle-case-select" style="padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); color: white; border: 1px solid #4ecdc4; margin: 10px;">
            <!-- Battle case options will be populated -->
          </select>
          <div style="margin: 10px 0;">
            <label>Wager Amount: $</label>
            <input type="number" id="battle-wager" value="100" min="10" max="10000" style="padding: 8px; border-radius: 5px; background: rgba(255,255,255,0.1); color: white; border: 1px solid #4ecdc4; margin-left: 10px;">
          </div>
        </div>
        <div class="battle-opponents" id="battle-opponents">
          <!-- Battle opponents will be generated by JavaScript -->
        </div>
        <button class="spin-btn" onclick="startCaseBattle()" id="start-battle-btn">Start Case Battle</button>
        <div id="battle-results" style="margin-top: 20px; display: none;">
          <!-- Battle results will be shown here -->
        </div>
      </div>
    </div>

    <!-- Premium Screen -->
    <div id="premium" class="screen">
      <div class="clan-card">
        <h2>üíé Premium Pass</h2>
        <p style="margin: 20px 0;">Unlock exclusive benefits:</p>
        <ul style="text-align: left; margin: 20px 0;">
          <li>üöÄ Faster spin animations</li>
          <li>üí∞ Double AFK income ($2/hour)</li>
          <li>üéÅ Extra free case daily</li>
          <li>üçÄ Hourly luck tokens</li>
          <li>üè™ Reduced marketplace fees</li>
        </ul>
        <button class="spin-btn" onclick="togglePremium()">Toggle Premium</button>
      </div>
    </div>

    <!-- Obsidian Vault Screen -->
    <div id="vault" class="screen">
      <div style="background: linear-gradient(135deg, #2c1810, #1a0f08); border-radius: 20px; padding: 30px; margin: 20px 0; border: 3px solid #8b4513; box-shadow: 0 0 30px rgba(139, 69, 19, 0.5);">
        <h2 style="color: #ffd700; margin-bottom: 20px;">üèõÔ∏è OBSIDIAN VAULT EVENT</h2>
        <p style="margin-bottom: 20px;">Exclusive event lasting until September 30th, 2024!</p>
        <div style="background: linear-gradient(45deg, #ffd700, #ffb300); color: #000; padding: 15px 25px; border-radius: 15px; font-size: 18px; font-weight: bold; margin: 20px 0; display: inline-block;">
          Vault Keys: <span id="vault-key-count">0</span> üîë
        </div>
        <p style="margin: 20px 0;">Exchange 500 Luck Tokens for 1 Vault Key</p>
        <button style="background: linear-gradient(135deg, #8b4513, #a0522d); border: none; color: white; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; margin: 10px; transition: all 0.3s ease;" onclick="exchangeForVaultKey()" id="vault-exchange">
          Exchange Tokens (500 ‚Üí 1 Key)
        </button>
        <div style="margin: 30px 0;">
          <h3>üé≤ Roll for Vault Case</h3>
          <p>Use 1 Vault Key to roll for a random vault case!</p>
          <button style="background: linear-gradient(135deg, #8b4513, #a0522d); border: none; color: white; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; margin: 10px; transition: all 0.3s ease;" onclick="rollVaultCase()" id="vault-roll" disabled>
            Roll Vault Case (1 Key)
          </button>
        </div>
        <div id="vault-cases" style="margin-top: 30px;">
          <!-- Vault cases will be generated here -->
        </div>
      </div>
    </div>

    <!-- Quests Screen -->
    <div id="quests" class="screen">
      <h2 style="margin-bottom: 20px;">üìã Daily Quests</h2>
      <div class="quest-list" id="quest-list">
        <!-- Quests will be generated by JavaScript -->
      </div>
    </div>

    <!-- Clans Screen -->
    <div id="clans" class="screen">
      <div class="clan-card">
        <div class="clan-banner">üõ°Ô∏è</div>
        <h2 id="clan-name">Shadow Ops</h2>
        <p>Level 15 ‚Ä¢ 24 Members</p>
        <div class="exp-bar">
          <div class="exp-progress" style="width: 67%;"></div>
        </div>
        <p style="margin: 10px 0;">Clan EXP: 6,700 / 10,000</p>
        
        <div class="clan-bank">
          <h3>üè¶ Clan Bank</h3>
          <p>Shared Funds: $<span id="clan-bank-balance">50,000</span></p>
          <div style="margin: 15px 0;">
            <input type="number" id="clan-deposit" placeholder="Amount to deposit" style="padding: 8px; border-radius: 5px; background: rgba(255,255,255,0.1); color: white; border: 1px solid #ffd700; margin-right: 10px;">
            <button class="buy-btn" onclick="depositToClan()">Deposit</button>
            <button class="buy-btn" onclick="withdrawFromClan()">Withdraw</button>
          </div>
        </div>
        
        <div style="margin: 20px 0;">
          <h3>üéØ Clan Goals</h3>
          <div class="quest-item">
            <div>
              <div style="font-weight: bold;">Weekly Case Opening</div>
              <div class="quest-progress">
                <div class="quest-progress-bar" style="width: 67%;"></div>
              </div>
              <div style="font-size: 12px;">6,700 / 10,000 cases</div>
            </div>
            <div style="color: #4ecdc4;">Reward: $10,000</div>
          </div>
        </div>
        
        <button class="buy-btn" onclick="leaveClan()" style="margin-top: 15px;">Leave Clan</button>
      </div>
    </div>

    <!-- Achievements Screen -->
    <div id="achievements" class="screen">
      <h2 style="margin-bottom: 20px;">üèÜ Achievements</h2>
      <div class="quest-list" id="achievement-list">
        <!-- Achievements will be generated by JavaScript -->
      </div>
    </div>

    <!-- Fusion Screen -->
    <div id="fusion" class="screen">
      <h2 style="margin-bottom: 20px;">‚öóÔ∏è Skin Fusion</h2>
      <div class="clan-card">
        <h3>Fusion Workshop</h3>
        <p style="margin: 15px 0;">Combine 5 skins of the same rarity to create 1 skin of higher rarity!</p>
        <div id="fusion-slots" style="display: flex; gap: 10px; justify-content: center; margin: 20px 0;">
          <!-- Fusion slots will be generated by JavaScript -->
        </div>
        <button class="spin-btn" onclick="performFusion()" id="fusion-btn" disabled>Fuse Skins</button>
        <div style="margin-top: 20px;">
          <h4>Fragment Exchange</h4>
          <p>Convert duplicate skins to fragments: <span id="fragment-count">0</span> fragments available</p>
          <button class="buy-btn" onclick="convertDuplicates()">Convert Duplicates</button>
        </div>
      </div>
    </div>

    <!-- Daily Rewards Screen -->
    <div id="dailyrewards" class="screen">
      <h2 style="margin-bottom: 20px;">üéÅ Daily Rewards</h2>
      <div class="clan-card">
        <h3>Daily Login Streak: <span id="streak-count">0</span> days</h3>
        <div id="daily-calendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 15px; margin: 20px 0;">
          <!-- Daily reward calendar will be generated by JavaScript -->
        </div>
        <button class="spin-btn" onclick="claimDailyReward()" id="daily-claim-btn">Claim Today's Reward</button>
      </div>
    </div>

    <!-- Leaderboards Screen -->
    <div id="leaderboards" class="screen">
      <h2 style="margin-bottom: 20px;">üèÜ Leaderboards</h2>
      <table class="leaderboard-table">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Player</th>
            <th>Net Worth</th>
            <th>Rarest Skin</th>
          </tr>
        </thead>
        <tbody id="leaderboard-body">
          <!-- Leaderboard data will be generated by JavaScript -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Spinner Modal -->
  <div id="spinner-modal" class="modal">
    <div class="modal-content">
      <button class="close-modal" onclick="closeSpinner()">&times;</button>
      <h2 id="case-title">Opening Case...</h2>
      <div class="spinner-container">
        <div class="spinner-wheel" id="spinner-wheel">
          <div class="spinner-items" id="spinner-items">
            <!-- Spinner items will be populated here -->
          </div>
          <div class="spinner-highlight"></div>
          <div class="spinner-pointer"></div>
        </div>
        <button class="spin-btn" id="spin-button" onclick="spinCase()">SPIN!</button>
      </div>
    </div>
  </div>

  <!-- Trade Window -->
  <div id="trade-modal" class="modal">
    <div class="trade-window">
      <button class="close-modal" onclick="closeTrade()">&times;</button>
      <h2>ü§ù Trade Window</h2>
      <div style="display: flex; gap: 20px;">
        <div style="flex: 1;">
          <h3>Your Offer</h3>
          <div id="your-trade-items" style="min-height: 100px; border: 2px dashed #4ecdc4; border-radius: 10px; padding: 10px;">
            Drop items here
          </div>
        </div>
        <div style="flex: 1;">
          <h3>Their Offer</h3>
          <div id="their-trade-items" style="min-height: 100px; border: 2px dashed #ff6b6b; border-radius: 10px; padding: 10px;">
            A will offer items
          </div>
        </div>
      </div>
      <button class="spin-btn" onclick="confirmTrade()" style="margin-top: 20px;">Confirm Trade</button>
    </div>
  </div>

  <!-- Reward Modal -->
  <div id="reward-modal" class="modal">
    <div class="modal-content reward-animation">
      <button class="close-modal" onclick="closeReward()">&times;</button>
      <h2>üéâ Congratulations!</h2>
      <div class="skin-icon" id="reward-icon" style="width: 120px; height: 120px; margin: 20px auto; font-size: 48px;"></div>
      <h3 id="reward-name">Awesome Skin</h3>
      <p id="reward-value">Value: $1,234</p>
      <button class="buy-btn" onclick="closeReward()" style="margin-top: 20px;">Awesome!</button>
    </div>
  </div>

  <script>
    // Game Data Storage
    let gameData = {
      balance: 5,
      inventory: [],
      premium: false,
      luckTokens: 3,
      clan: "Shadow Ops",
      quests: {
        openCases: 0,
        battleWins: 0,
        marketTrades: 0,
        spendMoney: 0
      },
      achievements: [],
      afkTimer: 1800, // 30 minutes in seconds
      lastSave: Date.now(),
      pityCounter: {},
      dailyRewards: {
        lastClaim: 0,
        streak: 0,
        day: 1
      },
      netWorthRank: "Bronze",
      eventCases: {},
      fragments: 0,
      totalSpent: 0,
      casesOpened: 0,
      rarestPull: { name: "None", rarity: "white" },
      vaultKeys: 0,
      obsidianVaultUnlocked: false,
      level: 1,
      exp: 0,
      theme: 'dark',
      clanBank: 50000,
      marketListings: [],
      battleStats: {
        wins: 0,
        losses: 0,
        totalEarnings: 0
      },
      lastAFKClaim: Date.now()
    };

    // Expanded Skin Database with 800 skins
    const skinDatabase = {
      white: [
        { name: "Basic Knife", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üî™", value: 1 },
        { name: "Simple Pistol", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üî´", value: 2 },
        { name: "Wood Stock", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü™µ", value: 1 },
        { name: "Iron Sight", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üéØ", value: 2 },
        { name: "Plain Grip", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=‚úã", value: 1 },
        { name: "Starter Blade", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=‚öîÔ∏è", value: 2 },
        { name: "Rookie Rifle", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üèπ", value: 2 },
        { name: "Basic Scope", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üîç", value: 1 },
        { name: "Training Sword", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üó°Ô∏è", value: 1 },
        { name: "Novice Axe", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü™ì", value: 2 },
        { name: "Rusty Blade", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üîß", value: 1 },
        { name: "Worn Gloves", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üß§", value: 1 },
        { name: "Old Boot", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü•æ", value: 1 },
        { name: "Cracked Shield", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üõ°Ô∏è", value: 2 },
        { name: "Bent Arrow", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üèπ", value: 1 },
        { name: "Dull Spear", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üó°Ô∏è", value: 1 },
        { name: "Wooden Club", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üèè", value: 1 },
        { name: "Stone Hammer", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üî®", value: 2 },
        { name: "Leather Strap", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üéí", value: 1 },
        { name: "Iron Ring", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üíç", value: 1 },
        { name: "Cloth Bandage", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü©π", value: 1 },
        { name: "Wooden Stick", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü™Ñ", value: 1 },
        { name: "Rope Coil", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü™¢", value: 1 },
        { name: "Canvas Bag", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üëú", value: 1 },
        { name: "Metal Scrap", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=‚öôÔ∏è", value: 1 },
        { name: "Broken Chain", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=‚õìÔ∏è", value: 1 },
        { name: "Worn Hat", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üé©", value: 1 },
        { name: "Old Coin", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=ü™ô", value: 1 },
        { name: "Torn Page", iron: "https://via.placeholder.com/80x80/ffffff/000000?text=üìÑ", value: 1 },
        { name: "Dusty Bottle", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üç∂", value: 1 },
        { name: "Faded Map", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üó∫Ô∏è", value: 1 },
        { name: "Chipped Mug", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=‚òï", value: 1 },
        { name: "Bent Fork", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üç¥", value: 1 },
        { name: "Cracked Lens", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üîç", value: 1 },
        { name: "Worn Shoe", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üëû", value: 1 },
        { name: "Old Key", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üîë", value: 1 },
        { name: "Tattered Flag", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üè≥Ô∏è", value: 1 },
        { name: "Rusty Lock", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üîí", value: 1 },
        { name: "Broken Watch", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=‚åö", value: 1 },
        { name: "Faded Photo", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üì∑", value: 1 },
        { name: "Empty Vial", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=üß™", value: 1 }
      ],
      blue: [
        { name: "Blue Steel", icon: "üó°Ô∏è", value: 50 },
        { name: "Ocean Wave", icon: "üåä", value: 65 },
        { name: "Sky Hunter", icon: "‚òÅÔ∏è", value: 45 },
        { name: "Frost Bite", icon: "‚ùÑÔ∏è", value: 70 },
        { name: "Sapphire Edge", icon: "üíé", value: 80 },
        { name: "Arctic Wolf", icon: "üê∫", value: 55 },
        { name: "Ice Shard", icon: "üßä", value: 62 },
        { name: "Storm Breaker", icon: "‚õàÔ∏è", value: 58 },
        { name: "Tidal Force", icon: "üåÄ", value: 72 },
        { name: "Glacier Strike", icon: "üèîÔ∏è", value: 68 }
      ],
      purple: [
        { name: "Void Walker", icon: "üëª", value: 150 },
        { name: "Mystic Blade", icon: "üîÆ", value: 180 },
        { name: "Purple Haze", icon: "üåô", value: 120 },
        { name: "Shadow Strike", icon: "‚ö°", value: 200 },
        { name: "Amethyst Claw", icon: "üíú", value: 160 },
        { name: "Phantom Edge", icon: "üë§", value: 175 },
        { name: "Cosmic Drift", icon: "üåå", value: 165 },
        { name: "Nebula Burst", icon: "üí´", value: 190 },
        { name: "Spirit Blade", icon: "üåü", value: 155 },
        { name: "Twilight Fang", icon: "ü¶á", value: 185 }
      ],
      pink: [
        { name: "Rose Thorn", icon: "üåπ", value: 400 },
        { name: "Flamingo Wing", icon: "ü¶©", value: 350 },
        { name: "Cherry Blossom", icon: "üå∏", value: 450 },
        { name: "Sunset Blade", icon: "üåÖ", value: 380 },
        { name: "Neon Pink", icon: "üíñ", value: 420 },
        { name: "Sakura Storm", icon: "üå∫", value: 390 },
        { name: "Bubblegum Pop", icon: "üç≠", value: 410 },
        { name: "Cotton Candy", icon: "üç•", value: 370 },
        { name: "Peach Fury", icon: "üçë", value: 440 },
        { name: "Magenta Mayhem", icon: "üéÄ", value: 395 }
      ],
      red: [
        { name: "Blood Moon", icon: "üåô", value: 800 },
        { name: "Crimson Fury", icon: "üî•", value: 950 },
        { name: "Ruby Strike", icon: "üíé", value: 750 },
        { name: "Phoenix Wing", icon: "üî•", value: 1100 },
        { name: "Inferno Blade", icon: "üåã", value: 900 },
        { name: "Dragon's Breath", icon: "üêâ", value: 850 },
        { name: "Lava Flow", icon: "üåã", value: 920 },
        { name: "Scarlet Reaper", icon: "üíÄ", value: 880 },
        { name: "Ember Strike", icon: "üî•", value: 970 },
        { name: "Crimson Crown", icon: "üëë", value: 1050 }
      ],
      yellow: [
        { name: "Golden Tiger", icon: "üêÖ", value: 2000 },
        { name: "Lightning Bolt", icon: "‚ö°", value: 2200 },
        { name: "Solar Flare", icon: "‚òÄÔ∏è", value: 1800 },
        { name: "Banana Split", icon: "üçå", value: 2500 },
        { name: "Thunder Strike", icon: "‚õàÔ∏è", value: 2100 },
        { name: "Electric Storm", icon: "üå©Ô∏è", value: 2300 },
        { name: "Golden Eagle", icon: "ü¶Ö", value: 1950 },
        { name: "Sunburst", icon: "üåû", value: 2150 },
        { name: "Lightning Rod", icon: "‚ö°", value: 2400 },
        { name: "Honey Badger", icon: "ü¶°", value: 1850 }
      ],
      golden: [
        { name: "Midas Touch", icon: "üëë", value: 5000 },
        { name: "Golden Dragon", icon: "üê≤", value: 5500 },
        { name: "Treasure Hunter", icon: "üè¥‚Äç‚ò†Ô∏è", value: 4800 },
        { name: "King's Crown", icon: "üëë", value: 6000 },
        { name: "Golden Phoenix", icon: "ü¶Ö", value: 5200 },
        { name: "Gilded Serpent", icon: "üêç", value: 5300 },
        { name: "Royal Scepter", icon: "ü™Ñ", value: 5700 },
        { name: "Golden Lotus", icon: "ü™∑", value: 4900 },
        { name: "Emperor's Blade", icon: "‚öîÔ∏è", value: 5800 },
        { name: "Golden Kraken", icon: "üêô", value: 5400 }
      ],
      black: [
        { name: "Obsidian Karambit", icon: "üñ§", value: 15000 },
        { name: "Void Emperor", icon: "üëë", value: 18000 },
        { name: "Shadow Legend", icon: "üåë", value: 12000 },
        { name: "Dark Matter", icon: "‚ö´", value: 20000 },
        { name: "Nightmare Blade", icon: "üòà", value: 16000 },
        { name: "Abyssal Crown", icon: "üëë", value: 22000 },
        { name: "Eclipse Edge", icon: "üåò", value: 14000 },
        { name: "Void Reaper", icon: "üíÄ", value: 19000 },
        { name: "Shadow King", icon: "üë§", value: 17000 },
        { name: "Dark Phoenix", icon: "ü¶Ö", value: 21000 }
      ],
      // Event-exclusive skins
      event: [
        { name: "Halloween Pumpkin", icon: "üéÉ", value: 3000, event: "Halloween", unsellable: true },
        { name: "Christmas Star", icon: "‚≠ê", value: 3500, event: "Christmas", unsellable: true },
        { name: "Valentine Heart", icon: "üíù", value: 2800, event: "Valentine", unsellable: true },
        { name: "Easter Bunny", icon: "üê∞", value: 3200, event: "Easter", unsellable: true },
        { name: "Summer Sun", icon: "üåû", value: 2900, event: "Summer", unsellable: true }
      ],
      // Obsidian Vault Exclusive Rarities
      volcanic: Array.from({length: 15}, (_, i) => ({
        name: `Volcanic Obsidian ${['Inferno Blade', 'Magma Cannon', 'Lava Staff', 'Molten Hammer', 'Fire Bow', 'Ember Gauntlets', 'Flame Cloak', 'Volcano Crown', 'Burning Heart', 'Phoenix Core'][ % 10]}`,
        icon: `https://via.placeholder.com/80x80/ff4500/ffffff?text=VO${ i +1}`,
        value: Math.floor(Math.random() * 100000) 100000
      })),
      obsidian: Array.from({length: 12}, (_, i) => ({
        name: `Pure Obsidian ${['Shadow Blade', 'Void Cannon', 'Dark Staff', 'Night Hammer', 'Eclipse Bow', 'Darkness Gauntlets', 'Midnight Cloak', 'Obsidian Crown', 'Black Heart', 'Void Core'][ i +% 10]}`,
        icon: `https://via.placeholder.com/80x80/2f2f2f/ffffff?text=PO${ i +1}`,
        value: Math.floor(Math.random() * 75000) 75000
      })),
      shattered: Array.from({length: 10}, (_, i) => ({
        name: `Shattered Obsidian ${['Broken Blade', 'Cracked Cannon', 'Split Staff', 'Fractured Hammer', 'Torn Bow', 'Shattered Gauntlets', 'Ripped Cloak', 'Cracked Crown', 'Broken Heart', 'Split Core'][ i +% 10]}`,
        icon: `https://via.placeholder.com/80x80/666666/ffffff?text=SO${ i +1}`,
        value: Math.floor(Math.random() * 50000) 50000
      }))
    };

    // Expanded Case Database with 60 cases
    const caseDatabase = [
      // Basic Cases (Properly balanced)
      { name: "Starter Case", icon: "https://via.placeholder.com/120x120/cccccc/000000?text=START", price: 5, drops: { white: 0.89, blue: 0.10, purple: 0.009, pink: 0.0009, red: 0.00009, shattered: 0.00000001 } },
      { name: "Common Case", icon: "https://via.placeholder.com/120x120/ffffff/000000?text=COMMON", price: 25, drops: { white: 0.78, blue: 0.18, purple: 0.035, pink: 0.0045, red: 0.0004, yellow: 0.00009, obsidian: 0.00000002, shattered: 0.0000001 } },
      { name: "Basic Case", icon: "https://via.placeholder.com/120x120/e0e0e0/000000?text=BASIC", price: 75, drops: { white: 0.65, blue: 0.28, purple: 0.06, pink: 0.009, red: 0.0009, yellow: 0.0001, obsidian: 0.00000005, shattered: 0.0000001 } },
      { name: "Rare Case", icon: "https://via.placeholder.com/120x120/3498db/ffffff?text=RARE", price: 200, drops: { white: 0.50, blue: 0.35, purple: 0.12, pink: 0.025, red: 0.004, yellow: 0.0009, golden: 0.00009, obsidian: 0.00000005, shattered: 0.0000001 } },
      { name: "Superior Case", icon: "https://via.placeholder.com/120x120/5dade2/ffffff?text=SUPER", price: 500, drops: { blue: 0.45, purple: 0.35, pink: 0.15, red: 0.045, yellow: 0.004, golden: 0.0009, black: 0.00009, volcanic: 0.000000005, shattered: 0.0000001 } },
      { name: "Epic Case", icon: "https://via.placeholder.com/120x120/9b59b6/ffffff?text=EPIC", price: 1200, drops: { blue: 0.30, purple: 0.40, pink: 0.22, red: 0.07, yellow: 0.007, golden: 0.002, black: 0.0009, volcanic: 0.000000005, shattered: 0.0000001 } },
      { name: "Elite Case", icon: "https://via.placeholder.com/120x120/8e44ad/ffffff?text=ELITE", price: 3000, drops: { purple: 0.35, pink: 0.35, red: 0.22, yellow: 0.07, golden: 0.009, black: 0.0009, volcanic: 0.00000001, obsidian: 0.00000002 } },
      { name: "Legendary Case", icon: "https://via.placeholder.com/120x120/e91e63/ffffff?text=LEGEND", price: 7500, drops: { purple: 0.25, pink: 0.40, red: 0.25, yellow: 0.08, golden: 0.019, black: 0.0009, volcanic: 0.00000001, obsidian: 0.00000002 } },
      { name: "Master Case", icon: "https://via.placeholder.com/120x120/c2185b/ffffff?text=MASTER", price: 15000, drops: { pink: 0.30, red: 0.40, yellow: 0.20, golden: 0.08, black: 0.019, volcanic: 0.0000001, obsidian: 0.0000005 } },
      { name: "Mythical Case", icon: "https://via.placeholder.com/120x120/f44336/ffffff?text=MYTH", price: 35000, drops: { pink: 0.20, red: 0.45, yellow: 0.25, golden: 0.08, black: 0.019, volcanic: 0.0000001, obsidian: 0.0000005 } },
      { name: "Ancient Case", icon: "https://via.placeholder.com/120x120/ff9800/ffffff?text=ANCIENT", price: 75000, drops: { red: 0.30, yellow: 0.40, golden: 0.25, black: 0.049, volcanic: 0.000001, obsidian: 0.000004 } },
      { name: "Divine Case", icon: "https://via.placeholder.com/120x120/ff5722/ffffff?text=DIVINE", price: 150000, drops: { red: 0.15, yellow: 0.45, golden: 0.35, black: 0.049, volcanic: 0.000001, obsidian: 0.000004 } },
      { name: "Golden Case", icon: "https://via.placeholder.com/120x120/ffd700/000000?text=GOLD", price: 300000, drops: { yellow: 0.35, golden: 0.50, black: 0.149, volcanic: 0.000001, obsidian: 0.000003 } },
      { name: "Supreme Case", icon: "https://via.placeholder.com/120x120/f39c12/000000?text=SUPREME", price: 600000, drops: { yellow: 0.20, golden: 0.60, black: 0.199, volcanic: 0.000001, obsidian: 0.000003 } },
      { name: "Immortal Case", icon: "https://via.placeholder.com/120x120/000000/ffffff?text=IMMORTAL", price: 1000000, drops: { golden: 0.50, black: 0.499, volcanic: 0.000001, obsidian: 0.000003 } },
      
      // Themed Cases (25 total themed cases)
      { name: "Fire Case", icon: "https://via.placeholder.com/120x120/ff4500/ffffff?text=FIRE", price: 800, drops: { blue: 0.30, purple: 0.30, pink: 0.25, red: 0.13, yellow: 0.019, golden: 0.0009, volcanic: 0.000001 } },
      { name: "Inferno Case", icon: "https://via.placeholder.com/120x120/dc143c/ffffff?text=INFERNO", price: 2500, drops: { purple: 0.25, pink: 0.30, red: 0.30, yellow: 0.13, golden: 0.019, black: 0.0009, volcanic: 0.000001 } },
      { name: "Ice Case", icon: "https://via.placeholder.com/120x120/87ceeb/000000?text=ICE", price: 800, drops: { blue: 0.35, purple: 0.30, pink: 0.20, red: 0.13, yellow: 0.019, golden: 0.0009, shattered: 0.000001 } },
      { name: "Frost Case", icon: "https://via.placeholder.com/120x120/4682b4/ffffff?text=FROST", price: 2500, drops: { purple: 0.25, pink: 0.30, red: 0.30, yellow: 0.13, golden: 0.019, black: 0.0009, shattered: 0.000001 } },
      { name: "Lightning Case", icon: "https://via.placeholder.com/120x120/ffff00/000000?text=BOLT", price: 1500, drops: { purple: 0.25, pink: 0.30, red: 0.25, yellow: 0.18, golden: 0.019, black: 0.0009, volcanic: 0.000001 } },
      { name: "Storm Case", icon: "https://via.placeholder.com/120x120/4169e1/ffffff?text=STORM", price: 4000, drops: { pink: 0.20, red: 0.30, yellow: 0.30, golden: 0.18, black: 0.019, volcanic: 0.000001 } },
      { name: "Earth Case", icon: "https://via.placeholder.com/120x120/8b4513/ffffff?text=EARTH", price: 1200, drops: { purple: 0.30, pink: 0.25, red: 0.25, yellow: 0.18, golden: 0.019, black: 0.0009, shattered: 0.000001 } },
      { name: "Nature Case", icon: "https://via.placeholder.com/120x120/228b22/ffffff?text=NATURE", price: 3500, drops: { pink: 0.25, red: 0.25, yellow: 0.30, golden: 0.18, black: 0.019, obsidian: 0.000001 } },
      { name: "Shadow Case", icon: "https://via.placeholder.com/120x120/2f2f2f/ffffff?text=SHADOW", price: 5000, drops: { purple: 0.20, pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.08, black: 0.019, obsidian: 0.000001 } },
      { name: "Darkness Case", icon: "https://via.placeholder.com/120x120/1c1c1c/ffffff?text=DARK", price: 12000, drops: { pink: 0.15, red: 0.25, yellow: 0.30, golden: 0.25, black: 0.049, obsidian: 0.000001 } },
      { name: "Light Case", icon: "https://via.placeholder.com/120x120/fffacd/000000?text=LIGHT", price: 5000, drops: { purple: 0.20, pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.08, black: 0.019, obsidian: 0.000001 } },
      { name: "Radiance Case", icon: "https://via.placeholder.com/120x120/fff8dc/000000?text=RADIANT", price: 12000, drops: { pink: 0.15, red: 0.25, yellow: 0.30, golden: 0.25, black: 0.049, volcanic: 0.000001 } },
      { name: "Crystal Case", icon: "https://via.placeholder.com/120x120/ff69b4/ffffff?text=CRYSTAL", price: 8000, drops: { pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.22, black: 0.029, shattered: 0.000001 } },
      { name: "Diamond Case", icon: "https://via.placeholder.com/120x120/b0c4de/000000?text=DIAMOND", price: 20000, drops: { red: 0.20, yellow: 0.30, golden: 0.35, black: 0.149, shattered: 0.000001 } },
      { name: "Demon Case", icon: "https://via.placeholder.com/120x120/8b0000/ffffff?text=DEMON", price: 15000, drops: { red: 0.25, yellow: 0.30, golden: 0.30, black: 0.149, volcanic: 0.000001 } },
      { name: "Devil Case", icon: "https://via.placeholder.com/120x120/660000/ffffff?text=DEVIL", price: 40000, drops: { yellow: 0.25, golden: 0.40, black: 0.349, volcanic: 0.000001 } },
      { name: "Angel Case", icon: "https://via.placeholder.com/120x120/ffffff/000000?text=ANGEL", price: 15000, drops: { red: 0.20, yellow: 0.30, golden: 0.35, black: 0.149, obsidian: 0.000001 } },
      { name: "Celestial Case", icon: "https://via.placeholder.com/120x120/f0f8ff/000000?text=CELESTIAL", price: 40000, drops: { yellow: 0.25, golden: 0.40, black: 0.349, obsidian: 0.000001 } },
      { name: "Dragon Case", icon: "https://via.placeholder.com/120x120/ff6347/ffffff?text=DRAGON", price: 50000, drops: { yellow: 0.20, golden: 0.45, black: 0.349, volcanic: 0.000001 } },
      { name: "Phoenix Case", icon: "https://via.placeholder.com/120x120/ff1493/ffffff?text=PHOENIX", price: 80000, drops: { golden: 0.50, black: 0.499, volcanic: 0.000001, obsidian: 0.000003 } },
      { name: "Titan Case", icon: "https://via.placeholder.com/120x120/708090/ffffff?text=TITAN", price: 60000, drops: { yellow: 0.25, golden: 0.40, black: 0.349, shattered: 0.000001 } },
      { name: "God Case", icon: "https://via.placeholder.com/120x120/daa520/000000?text=GOD", price: 200000, drops: { golden: 0.60, black: 0.399, volcanic: 0.0005, obsidian: 0.0005 } },
      { name: "Void Case", icon: "https://via.placeholder.com/120x120/4b0082/ffffff?text=VOID", price: 150000, drops: { golden: 0.30, black: 0.699, volcanic: 0.0005, obsidian: 0.0005 } },
      { name: "Cosmic Case", icon: "https://via.placeholder.com/120x120/191970/ffffff?text=COSMIC", price: 400000, drops: { black: 0.995, volcanic: 0.002, obsidian: 0.003 } },
      { name: "Universe Case", icon: "https://via.placeholder.com/120x120/000080/ffffff?text=UNIVERSE", price: 800000, drops: { black: 0.99, volcanic: 0.005, obsidian: 0.005 } },
      
      // Premium Cases
      { name: "VIP Vault", icon: "https://via.placeholder.com/120x120/ffd700/000000?text=VIP", price: 10000, premiumOnly: true, drops: { red: 0.15, yellow: 0.30, golden: 0.40, black: 0.149, volcanic: 0.0005, obsidian: 0.0005 } },
      { name: "Elite Vault", icon: "https://via.placeholder.com/120x120/b8860b/ffffff?text=ELITE", price: 50000, premiumOnly: true, drops: { yellow: 0.20, golden: 0.50, black: 0.299, volcanic: 0.0005, obsidian: 0.0005 } },
      { name: "Supreme Vault", icon: "https://via.placeholder.com/120x120/8b4513/ffffff?text=SUPREME", price: 200000, premiumOnly: true, drops: { golden: 0.40, black: 0.599, volcanic: 0.0005, obsidian: 0.0005 } },
      { name: "Ultimate Vault", icon: "https://via.placeholder.com/120x120/654321/ffffff?text=ULTIMATE", price: 500000, premiumOnly: true, drops: { golden: 0.30, black: 0.699, volcanic: 0.0005, obsidian: 0.0005 } },
      { name: "Infinite Vault", icon: "https://via.placeholder.com/120x120/2f1b14/ffffff?text=INFINITE", price: 1000000, premiumOnly: true, drops: { black: 0.995, volcanic: 0.002, obsidian: 0.003 } },
      
      // Event Cases
      { name: "Halloween Case", icon: "https://via.placeholder.com/120x120/ff8c00/000000?text=üéÉ", price: 666, isEvent: true, eventEnd: Date.now() (60 * 24 * 60 * 60 * 1000), drops: { purple: 0.20, pink: 0.25, red: 0.30, yellow: 0.20, golden: 0.049, black: 0.0009, shattered: 0.000001 } },
      { name: "Christmas Case", icon: "https://via.placeholder.com/120x120/228b22/ffffff?text=üéÑ", price: 777, isEvent: true, eventEnd: Date.now() (90 * 24 * 60 * 60 * 1000), drops: { purple: 0.15, pink: 0.25, red: 0.30, yellow: 0.25, golden: 0.049, black: 0.0009, obsidian: 0.000001 } },
      { name: "Valentine Case", icon: "https://via.placeholder.com/120x120/ff1493/ffffff?text=üíù", price: 999, isEvent: true, eventEnd: Date.now() (45 * 24 * 60 * 60 * 1000), drops: { purple: 0.15, pink: 0.30, red: 0.30, yellow: 0.20, golden: 0.049, black: 0.0009, volcanic: 0.000001 } },
      { name: "Easter Case", icon: "https://via.placeholder.com/120x120/98fb98/000000?text=üê∞", price: 888, isEvent: true, eventEnd: Date.now() (30 * 24 * 60 * 60 * 1000), drops: { purple: 0.20, pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.049, black: 0.0009, shattered: 0.000001 } },
      
      // Obsidian Vault Cases (unlocked with vault keys) - Available in marketplace with extreme prices
      { name: "Shattered Obsidian Vault", icon: "https://via.placeholder.com/120x120/666666/ffffff?text=SHARD", price: 0, isVaultCase: true, vaultTier: 3, marketPrice: 5000000, drops: { black: 0.60, shattered: 0.40 } },
      { name: "Obsidian Vault", icon: "https://via.placeholder.com/120x120/2f2f2f/ffffff?text=OBSID", price: 0, isVaultCase: true, vaultTier: 2, marketPrice: 15000000, drops: { black: 0.40, obsidian: 0.60 } },
      { name: "Volcanic Obsidian Vault", icon: "https://via.placeholder.com/120x120/ff4500/ffffff?text=VOLC", price: 0, isVaultCase: true, vaultTier: 1, marketPrice: 50000000, drops: { black: 0.20, volcanic: 0.80 } }
    ];

    // Daily Rewards
    const dailyRewards = [
      { day: 1, reward: 10, type: "currency" },
      { day: 2, reward: 1, type: "tokens" },
      { day: 3, reward: 25, type: "currency" },
      { day: 4, reward: 2, type: "tokens" },
      { day: 5, reward: 50, type: "currency" },
      { day: 6, reward: 3, type: "tokens" },
      { day: 7, reward: 100, type: "currency" }
    ];

    // Initialize Game
    function initGame() {
      loadGameData();
      generateCases();
      generateVaultCases();
      generateQuests();
      generateAchievements();
      generateMarketplace();
      generateLeaderboard();
      generateDailyRewards();
      updateUI();
      startAFKTimer();
      checkVaultExpiry();
      
      // Update timers every minute
      setInterval(() => {
        updateDailyRewardTimer();
        updateUI();
      }, 60000);
    }

    // Exchange Tokens for Vault Key
    function exchangeForVaultKey() {
      if (gameData.luckTokens < 500) {
        showNotification("You need 500 Luck Tokens to exchange for a Vault Key!");
        return;
      }
      
      gameData.luckTokens -= 500;
      gameData.vaultKeys;
      
      showNotification("Exchanged 500 Luck Tokens for 1 Vault Key!");
      updateUI();
      saveGameData();
    }

    // Roll Vault Case
    function rollVaultCase() {
      if (gameData.vaultKeys < 1) {
        showNotification("You need at least 1 Vault Key!");
        return;
      }
      
      gameData.vaultKeys--;
      
      // Random roll for vault case (weighted towards lower tiers)
      const roll = Math.random();
      let selectedCase;
      
      if (roll < 0.60) {
        // 60% chance for Tier 3 (Shattered)
        selectedCase = caseDatabase.find(c => c.vaultTier === 3);
      } else if (roll < 0.90) {
        // 30% chance for Tier 2 (Obsidian)
        selectedCase = caseDatabase.find(c => c.vaultTier === 2);
      } else {
        // 10% chance for Tier 1 (Volcanic)
        selectedCase = caseDatabase.find(c => c.vaultTier === 1);
      }
      
      showNotification(`üé≤ Rolled ${selectedCase.name}! Opening now...`);
      
      setTimeout(() => {
        document.getElementById('case-title').textContent = `Opening ${selectedCase.name}...`;
        document.getElementById('spinner-modal').style.display = 'block';
        window.currentCase = selectedCase;
      }, 1000);
      
      updateUI();
      saveGameData();
    }

    // Generate Vault Cases
    function generateVaultCases() {
      const vaultContainer = document.getElementById('vault-cases');
      if (!vaultContainer) return;
      
      // Check if vault event is still active
      const vaultEndDate = new Date('2024-09-30');
      const now = new Date();
      
      if (now > vaultEndDate) {
        vaultContainer.innerHTML = '<p style="color: #ff6b6b; font-size: 18px;">Obsidian Vault Event has ended!</p>';
        return;
      }
      
      vaultContainer.innerHTML = '<h3 style="margin-bottom: 20px;">Vault Cases (Requires Vault Keys)</h3>';
      
      const vaultCases = caseDatabase.filter(c => c.isVaultCase).sort((a, b) => a.vaultTier - b.vaultTier);
      
      vaultCases.forEach((caseData, index) => {
        const caseCard = document.createElement('div');
        caseCard.className = 'case-card';
        caseCard.style.border = `3px solid ${caseData.vaultTier === 1 ? '#ff4500' : caseData.vaultTier === 2 ? '#2f2f2f' : '#666666'}`;
        
        caseCard.innerHTML = `
          <div class="case-image">
            <img src="${caseData.icon}" alt="${caseData.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 15px;">
          </div>
          <div class="case-name">${caseData.name}</div>
          <div class="case-price">1 Vault Key üîë</div>
          <div style="font-size: 12px; margin-top: 10px;">Tier ${caseData.vaultTier} (${caseData.vaultTier === 1 ? 'Best' : caseData.vaultTier === 2 ? 'Great' : 'Good'})</div>
        `;
        caseCard.onclick = () => openVaultCase(caseData);
        vaultContainer.appendChild(caseCard);
      });
    }

    // Open Vault Case
    function openVaultCase(caseData) {
      if (gameData.vaultKeys < 1) {
        showNotification("You need a Vault Key to open this case!");
        return;
      }
      
      gameData.vaultKeys--;
      
      document.getElementById('case-title').textContent = `Opening ${caseData.name}...`;
      document.getElementById('spinner-modal').style.display = 'block';
      
      window.currentCase = caseData;
      updateUI();
      saveGameData();
    }

    // Check Vault Expiry
    function checkVaultExpiry() {
      const vaultEndDate = new Date('2024-09-30');
      const now = new Date();
      
      if (now > vaultEndDate) {
        // Make obsidian vault skins sellable
        gameData.inventory.forEach(skin => {
          if (['volcanic', 'obsidian', 'shattered'].includes(skin.rarity)) {
            skin.sellable = true;
          }
        });
        saveGameData();
      }
    }

    // Enhanced Update UI
    function updateUI() {
      document.getElementById('balance').textContent = `$${gameData.balance.toLocaleString()}`;
      document.getElementById('tokens').textContent = gameData.luckTokens.toLocaleString();
      document.getElementById('vault-keys').textContent = gameData.vaultKeys;
      document.getElementById('fragments').textContent = gameData.fragments;
      
      const inventoryValue = gameData.inventory.reduce((sum, skin) => sum skin.value, 0);
      const netWorth = gameData.balance inventoryValue;
      document.getElementById('networth').textContent = `$${netWorth.toLocaleString()}`;
      
      // Update rank
      const rank = getCurrentRank();
      document.getElementById('rank').textContent = rank.name;
      document.getElementById('rank').style.color = rank.color;
      
      document.getElementById('premium-status').textContent = gameData.premium ? 'Premium' : 'Free';
      document.getElementById('premium-status').style.background = gameData.premium 
        ? 'linear-gradient(45deg, #ffd700, #ffed4e)' 
        : 'rgba(255, 255, 255, 0.2)';
        
      // Update vault key count in vault screen
      const vaultKeyCount = document.getElementById('vault-key-count');
      if (vaultKeyCount) vaultKeyCount.textContent = gameData.vaultKeys;
      
      // Update exchange button
      const exchangeBtn = document.getElementById('vault-exchange');
      if (exchangeBtn) {
        exchangeBtn.disabled = gameData.luckTokens < 500;
        exchangeBtn.textContent = `Exchange Tokens (${gameData.luckTokens}/500 ‚Üí 1 Key)`;
      }
      
      // Update roll button
      const rollBtn = document.getElementById('vault-roll');
      if (rollBtn) {
        rollBtn.disabled = gameData.vaultKeys < 1;
        rollBtn.textContent = `Roll Vault Case (${gameData.vaultKeys}/1 Key)`;
      }
    }

    // Fixed Daily Rewards System
    function canClaimToday() {
      if (gameData.dailyRewards.lastClaim === 0) return true;
      
      const now = Date.now();
      const lastClaim = gameData.dailyRewards.lastClaim;
      const diffTime = now - lastClaim;
      const diffHours = diffTime / (1000 * 60 * 60);
      
      return diffHours >= 24;
    }

    function isRewardClaimedToday() {
      if (gameData.dailyRewards.lastClaim === 0) return false;
      
      const now = Date.now();
      const lastClaim = gameData.dailyRewards.lastClaim;
      const diffTime = now - lastClaim;
      const diffHours = diffTime / (1000 * 60 * 60);
      
      return diffHours < 24;
    }

    function getTimeUntilNextReward() {
      if (gameData.dailyRewards.lastClaim === 0) return "Available now!";
      
      const now = Date.now();
      const lastClaim = gameData.dailyRewards.lastClaim;
      const diffTime = now - lastClaim;
      const hoursLeft = 24 - (diffTime / (1000 * 60 * 60));
      
      if (hoursLeft <= 0) return "Available now!";
      
      const hours = Math.floor(hoursLeft);
      const minutes = Math.floor((hoursLeft - hours) * 60);
      
      return `${hours}h ${minutes}m`;
    }

    function updateDailyRewardTimer() {
      const claimBtn = document.getElementById('daily-claim-btn');
      if (!claimBtn) return;
      
      if (canClaimToday() && !isRewardClaimedToday()) {
        claimBtn.textContent = "Claim Today's Reward";
        claimBtn.disabled = false;
      } else {
        const timeLeft = getTimeUntilNextReward();
        claimBtn.textContent = `Next reward in: ${timeLeft}`;
        claimBtn.disabled = true;
      }
    }

    function claimDailyReward() {
      if (!canClaimToday()) {
        showNotification("You can only claim once per day!");
        return;
      }
      
      if (isRewardClaimedToday()) {
        showNotification("Already claimed today!");
        return;
      }
      
      const currentReward = dailyRewards[gameData.dailyRewards.day - 1];
      
      if (currentReward.type === 'tokens') {
        gameData.luckTokens = currentReward.reward;
      } else {
        gameData.balance = currentReward.reward;
      }
      
      gameData.dailyRewards.lastClaim = Date.now();
      gameData.dailyRewards.streak;
      gameData.dailyRewards.day = (gameData.dailyRewards.day % 7) 1;
      
      showNotification(`Daily reward claimed! ${currentReward.reward} ${currentReward.type === 'tokens' ? 'tokens' : '$'}`);
      updateUI();
      generateDailyRewards();
      saveGameData();
    }

    // Generate Daily Rewards
    function generateDailyRewards() {
      const calendar = document.getElementById('daily-calendar');
      if (!calendar) return;
      
      calendar.innerHTML = '';
      
      dailyRewards.forEach((reward, index) => {
        const day = index 1;
        const isToday = canClaimToday() && day === gameData.dailyRewards.day;
        const isClaimed = isRewardClaimedToday() && day === gameData.dailyRewards.day;
        
        const dayDiv = document.createElement('div');
        dayDiv.className = `daily-reward-day ${isClaimed ? 'claimed' : ''} ${isToday && !isClaimed ? 'current' : ''}`;
        dayDiv.innerHTML = `
          <div style="font-weight: bold;">Day ${day}</div>
          <div style="font-size: 24px; margin: 10px 0;">${reward.type === 'tokens' ? 'üçÄ' : 'üí∞'}</div>
          <div style="font-size: 14px;">${reward.reward} ${reward.type === 'tokens' ? 'Tokens' : '$'}</div>
        `;
        calendar.appendChild(dayDiv);
      });
    }

    // Net Worth Rank System
    const netWorthRanks = [
      { name: "Bronze", threshold: 0, color: "#CD7F32" },
      { name: "Silver", threshold: 1000, color: "#C0C0C0" },
      { name: "Gold", threshold: 10000, color: "#FFD700" },
      { name: "Diamond", threshold: 100000, color: "#B9F2FF" },
      { name: "Obsidian", threshold: 1000000, color: "#36454F" }
    ];

    function getCurrentRank() {
      const inventoryValue = gameData.inventory.reduce((sum, skin) => sum skin.value, 0);
      const netWorth = gameData.balance inventoryValue;
      
      for (let  i += netWorthRanks.length - 1;  i +>= 0; i--) {
        if (netWorth >= netWorthRanks[i].threshold) {
          return netWorthRanks[i];
        }
      }
      return netWorthRanks[0];
    }

    // Generate Cases with Enhanced Filtering
    function generateCases() {
      const caseGrid = document.getElementById('case-grid');
      caseGrid.innerHTML = '';
      
      caseDatabase.forEach((caseData, index) => {
        if (caseData.isVaultCase) return; // Skip vault cases in main grid
        if (caseData.premiumOnly && !gameData.premium) return;
        if (caseData.isEvent && Date.now() > caseData.eventEnd) return;
        
        const caseCard = document.createElement('div');
        caseCard.className = 'case-card';
        
        let eventTimer = '';
        if (caseData.isEvent) {
          const timeLeft = caseData.eventEnd - Date.now();
          const days = Math.floor(timeLeft / (24 * 60 * 60 * 1000));
          eventTimer = `<div class="event-timer">${days} days left</div>`;
        }
        
        let premiumBadge = '';
        if (caseData.premiumOnly) {
          premiumBadge = '<div style="background: #ffd700; color: #000; padding: 5px 10px; border-radius: 10px; font-size: 10px; font-weight: bold; margin-top: 5px;">PREMIUM</div>';
        }
        
        caseCard.innerHTML = `
          <div class="case-image">
            <img src="${caseData.icon}" alt="${caseData.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 15px;">
          </div>
          <div class="case-name">${caseData.name}</div>
          <div class="case-price">$${caseData.price.toLocaleString()}</div>
          ${eventTimer}
          ${premiumBadge}
        `;
        caseCard.onclick = () => openCase(index);
        caseGrid.appendChild(caseCard);
      });
    }

    // Enhanced Determine Rarity with Pity System
    function determineRarity(dropRates, caseName) {
      const random = Math.random();
      let cumulative = 0;
      
      // Apply luck token bonus and rank bonus
      const rank = getCurrentRank();
      const luckMultiplier = gameData.luckTokens > 0 ? 1.2 : 1;
      const rankMultiplier = rank.name === 'Bronze' ? 1 : 1 (netWorthRanks.indexOf(rank) * 0.05);
      
      for (const [rarity, rate] of Object.entries(dropRates)) {
        const adjustedRate = rate * (rarity !== 'white' ? luckMultiplier * rankMultiplier : 1);
        cumulative = adjustedRate;
        if (random <= cumulative) {
          // Consume luck token for rare drops
          if (gameData.luckTokens > 0 && ['red', 'yellow', 'golden', 'black', 'volcanic', 'obsidian', 'shattered'].includes(rarity)) {
            gameData.luckTokens--;
          }
          
          return rarity;
        }
      }
      
      return 'white'; // Fallback
    }

    // Enhanced Marketplace System
    function showMarketTab(tab) {
      document.querySelectorAll('.market-tab').forEach(t => t.style.display = 'none');
      document.querySelectorAll('#marketplace .nav-btn').forEach(btn => btn.classList.remove('active'));
      
      document.getElementById(`marketplace-${tab}`).style.display = 'block';
      document.getElementById(`market-${tab}`).classList.add('active');
      
      if (tab === 'sell') generateSellableInventory();
      if (tab === 'vault') generateVaultMarketplace();
    }

    function generateSellableInventory() {
      const container = document.getElementById('sellable-inventory');
      container.innerHTML = '';
      
      gameData.inventory.forEach((skin, index) => {
        if (skin.unsellable) return;
        
        const skinItem = document.createElement('div');
        skinItem.className = 'skin-item';
        skinItem.innerHTML = `
          <div class="skin-icon rarity-${skin.rarity}">
            ${skin.icon.startsWith('http') ? 
              `<img src="${skin.icon}" alt="${skin.name}">` : skin.icon
            }
          </div>
          <div class="skin-name">${skin.name}</div>
          <div class="skin-value">$${skin.value.toLocaleString()}</div>
          <button class="buy-btn" onclick="listSkinForSale(${index})">List for Sale</button>
        `;
        container.appendChild(skinItem);
      });
    }

    function listSkinForSale(skinIndex) {
      const skin = gameData.inventory[skinIndex];
      const price = Math.floor(skin.value * (1.1 Math.random() * 0.4)); // 110-150% markup
      
      gameData.marketListings.push({
        ...skin,
        price: price,
        listTime: Date.now(),
        originalIndex: skinIndex
      });
      
      gameData.inventory.splice(skinIndex, 1);
      showNotification(`Listed ${skin.name} for $${price.toLocaleString()}!`);
      generateSellableInventory();
      updateMarketplace();
      updateUI();
      saveGameData();
    }

    function generateVaultMarketplace() {
      const container = document.getElementById('vault-marketplace-listings');
      container.innerHTML = '';
      
      const vaultCases = caseDatabase.filter(c => c.isVaultCase);
      
      vaultCases.forEach(caseData => {
        const caseCard = document.createElement('div');
        caseCard.className = 'marketplace-item';
        caseCard.innerHTML = `
          <div class="skin-icon" style="background: ${caseData.vaultTier === 1 ? '#ff4500' : caseData.vaultTier === 2 ? '#2f2f2f' : '#666666'};">
            <img src="${caseData.icon}" alt="${caseData.name}">
          </div>
          <div class="item-info">
            <div class="item-name">${caseData.name}</div>
            <div class="item-price" style="color: #ff6b6b;">$${caseData.marketPrice.toLocaleString()}</div>
            <small>Slightly better odds than common cases</small>
          </div>
          <button class="buy-btn" onclick="buyVaultCase('${caseData.name}')">Buy</button>
        `;
        container.appendChild(caseCard);
      });
    }

    function buyVaultCase(caseName) {
      const caseData = caseDatabase.find(c => c.name === caseName);
      if (gameData.balance < caseData.marketPrice) {
        showNotification(`Need $${caseData.marketPrice.toLocaleString()}!`);
        return;
      }
      
      if (!confirm(`Buy ${caseName} for $${caseData.marketPrice.toLocaleString()}?`)) return;
      
      gameData.balance -= caseData.marketPrice;
      openCase(caseDatabase.indexOf(caseData));
    }

    // Enhanced Case Battle System
    function populateBattleCases() {
      const select = document.getElementById('battle-case-select');
      select.innerHTML = '';
      
      caseDatabase.forEach((caseData, index) => {
        if (caseData.isVaultCase || caseData.premiumOnly) return;
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `${caseData.name} ($${caseData.price})`;
        select.appendChild(option);
      });
    }

    function startCaseBattle() {
      const caseIndex = document.getElementById('battle-case-select').value;
      const wager = parseInt(document.getElementById('battle-wager').value);
      const caseData = caseDatabase[caseIndex];
      
      if (gameData.balance < wager caseData.price) {
        showNotification("Not enough balance for battle!");
        return;
      }
      
      gameData.balance -= (wager caseData.price);
      
      // Generate A i +opponents
      const opponents = [
        { name: "CaseKing", avatar: "üëë", value: 0, skin: null },
        { name: "LootMaster", avatar: "üíé", value: 0, skin: null },
        { name: "SkinHunter", avatar: "üéØ", value: 0, skin: null }
      ];
      
      // Player opens case
      const playerRarity = determineRarity(caseData.drops, caseData.name);
      const playerSkin = skinDatabase[playerRarity][Math.floor(Math.random() * skinDatabase[playerRarity].length)];
      const playerValue = playerSkin.value;
      
      gameData.inventory.push({ ...playerSkin, rarity: playerRarity });
      
      // A i +opponents open cases
      opponents.forEach(opponent => {
        const aiRarity = determineRarity(caseData.drops, caseData.name);
        const aiSkin = skinDatabase[aiRarity][Math.floor(Math.random() * skinDatabase[aiRarity].length)];
        opponent.value = aiSkin.value;
        opponent.skin = aiSkin;
        opponent.rarity = aiRarity;
      });
      
      // Show battle results
      showBattleResults(playerValue, playerSkin, opponents, wager);
      updateUI();
      saveGameData();
    }

    function showBattleResults(playerValue, playerSkin, opponents, wager) {
      const resultsDiv = document.getElementById('battle-results');
      resultsDiv.style.display = 'block';
      resultsDiv.innerHTML = '';
      
      const allParticipants = [
        { name: "You", value: playerValue, skin: playerSkin, isPlayer: true },
        ...opponents
      ];
      
      allParticipants.sort((a, b) => b.value - a.value);
      const isWinner = allParticipants[0].isPlayer;
      
      allParticipants.forEach((participant, index) => {
        const div = document.createElement('div');
        div.className = `battle-participant ${index === 0 ? 'winner' : 'loser'}`;
        div.innerHTML = `
          <div style="font-size: 24px;">${participant.isPlayer ? 'üë§' : participant.avatar}</div>
          <div style="font-weight: bold;">${participant.name}</div>
          <div>Got: ${participant.skin.name}</div>
          <div style="color: #4ecdc4;">Value: $${participant.value.toLocaleString()}</div>
          ${index === 0 ? '<div style="color: #ffd700; font-weight: bold;">üèÜ WINNER!</div>' : ''}
        `;
        resultsDiv.appendChild(div);
      });
      
      if (isWinner) {
        const winnings = wager * 4; // Win 4x wager
        gameData.balance = winnings;
        gameData.battleStats.wins;
        gameData.battleStats.totalEarnings = winnings;
        showNotification(`üèÜ Battle Won! $${winnings.toLocaleString()}`);
      } else {
        gameData.battleStats.losses;
        showNotification("üíî Battle Lost!");
      }
    }

    // Theme System
    function setTheme(themeName) {
      gameData.theme = themeName;
      document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(`theme-${themeName}`).classList.add('active');
      
      const body = document.body;
      body.className = `theme-${themeName}`;
      
      switch (themeName) {
        case 'neon':
          body.style.background = 'linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 50%, #0a1a0a 100%)';
          break;
        case 'cs2':
          body.style.background = 'linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%)';
          break;
        case 'light':
          body.style.background = 'linear-gradient(135deg, #ecf0f1 0%, #bdc3c7 50%, #95a5a6 100%)';
          body.style.color = '#2c3e50';
          break;
        default:
          body.style.background = 'linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%)';
          body.style.color = '#ffffff';
      }
      
      saveGameData();
    }

    // Trading System
    function openTrade() {
      document.getElementById('trade-modal').style.display = 'block';
      generateTradeOffer();
    }

    function closeTrade() {
      document.getElementById('trade-modal').style.display = 'none';
    }

    function generateTradeOffer() {
      // A i +generates a random trade offer
      const aiSkin = getRandomSkin();
      document.getElementById('their-trade-items').innerHTML = `
        <div class="skin-item">
          <div class="skin-icon rarity-${aiSkin.rarity}">${aiSkin.icon}</div>
          <div class="skin-name">${aiSkin.name}</div>
          <div class="skin-value">$${aiSkin.value.toLocaleString()}</div>
        </div>
      `;
    }

    function getRandomSkin() {
      const rarities = Object.keys(skinDatabase);
      const randomRarity = rarities[Math.floor(Math.random() * rarities.length)];
      const skinPool = skinDatabase[randomRarity];
      const randomSkin = skinPool[Math.floor(Math.random() * skinPool.length)];
      return { ...randomSkin, rarity: randomRarity };
    }

    function confirmTrade() {
      showNotification("Trade confirmed! (Demo feature)");
      closeTrade();
    }

    // Clan Bank System
    function depositToClan() {
      const amount = parseInt(document.getElementById('clan-deposit').value);
      if (!amount || amount <= 0) {
        showNotification("Enter a valid amount!");
        return;
      }
      
      if (gameData.balance < amount) {
        showNotification("Not enough balance!");
        return;
      }
      
      gameData.balance -= amount;
      gameData.clanBank = amount;
      document.getElementById('clan-bank-balance').textContent = gameData.clanBank.toLocaleString();
      document.getElementById('clan-deposit').value = '';
      
      showNotification(`Deposited $${amount.toLocaleString()} to clan bank!`);
      updateUI();
      saveGameData();
    }

    function withdrawFromClan() {
      const amount = parseInt(document.getElementById('clan-deposit').value);
      if (!amount || amount <= 0) {
        showNotification("Enter a valid amount!");
        return;
      }
      
      if (gameData.clanBank < amount) {
        showNotification("Not enough in clan bank!");
        return;
      }
      
      gameData.clanBank -= amount;
      gameData.balance = amount;
      document.getElementById('clan-bank-balance').textContent = gameData.clanBank.toLocaleString();
      document.getElementById('clan-deposit').value = '';
      
      showNotification(`Withdrew $${amount.toLocaleString()} from clan bank!`);
      updateUI();
      saveGameData();
    }

    // Enhanced Spinner Animation
    function populateSpinnerItems(caseData) {
      const spinnerItems = document.getElementById('spinner-items');
      spinnerItems.innerHTML = '';
      
      // Create 8 items around the wheel
      for (let  i += 0;  i +< 8; i) {
        const angle = ( i +* 45) - 22.5; // Distribute evenly
        const rarity = Object.keys(caseData.drops)[ i +% Object.keys(caseData.drops).length];
        const skinPool = skinDatabase[rarity];
        const randomSkin = skinPool[Math.floor(Math.random() * skinPool.length)];
        
        const item = document.createElement('div');
        item.className = `spinner-item rarity-${rarity}`;
        item.style.transform = `rotate(${angle}deg) translateY(-170px)`;
        item.innerHTML = randomSkin.icon.startsWith('http') ? 
          `<img src="${randomSkin.icon}" style="width: 40px; height: 40px; border-radius: 50%;">` : 
          randomSkin.icon;
        
        spinnerItems.appendChild(item);
      }
    }

    // Enhanced Spin Case with Realistic Animation
    function spinCase() {
      const spinButton = document.getElementById('spin-button');
      const spinner = document.getElementById('spinner-wheel');
      
      spinButton.disabled = true;
      spinButton.textContent = 'SPINNING...';
      
      // Populate spinner with items from current case
      populateSpinnerItems(window.currentCase);
      
      // Determine rarity and winning skin
      const rarity = determineRarity(window.currentCase.drops, window.currentCase.name);
      const skinPool = skinDatabase[rarity];
      const wonSkin = skinPool[Math.floor(Math.random() * skinPool.length)];
      
      // Track rarest pull
      const rarityOrder = ['white', 'blue', 'purple', 'pink', 'red', 'yellow', 'golden', 'black', 'volcanic', 'obsidian', 'shattered'];
      if (rarityOrder.indexOf(rarity) > rarityOrder.indexOf(gameData.rarestPull.rarity)) {
        gameData.rarestPull = { name: wonSkin.name, rarity: rarity };
      }
      
      // Realistic spin animation with slowdown
      const spinDuration = gameData.premium ? 3000 : 4000;
      const finalRotation = 1800 Math.random() * 360;
      
      spinner.style.transition = `transform ${spinDuration}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
      spinner.style.transform = `rotate(${finalRotation}deg)`;
      
      // Create particles for higher rarities
      if (['red', 'yellow', 'golden', 'black', 'volcanic', 'obsidian', 'shattered'].includes(rarity)) {
        createParticleEffect(rarity);
      }
      
      // Add EXP for opening cases
      addEXP(10);
      
      setTimeout(() => {
        // Add skin to inventory
        const skinWithRarity = { ...wonSkin, rarity };
        gameData.inventory.push(skinWithRarity);
        
        // Show reward with enhanced effects
        showReward(skinWithRarity);
        
        // Reset spinner
        spinner.style.transition = 'none';
        spinner.style.transform = 'rotate(0deg)';
        spinButton.disabled = false;
        spinButton.textContent = 'SPIN!';
        
        updateUI();
        checkQuests();
        checkAchievements();
        saveGameData();
      }, spinDuration);
    }

    // Particle Effects System
    function createParticleEffect(rarity) {
      const colors = {
        red: '#f44336',
        yellow: '#ff9800', 
        golden: '#ffd700',
        black: '#000000',
        volcanic: '#ff4500',
        obsidian: '#2f2f2f',
        shattered: '#666666'
      };
      
      const particleCount = rarity === 'volcanic' || rarity === 'obsidian' ? 50 : 30;
      
      for (let  i += 0;  i +< particleCount; i) {
        setTimeout(() => {
          const particle = document.createElement('div');
          particle.style.position = 'fixed';
          particle.style.width = '8px';
          particle.style.height = '8px';
          particle.style.background = colors[rarity] || '#ffd700';
          particle.style.borderRadius = '50%';
          particle.style.pointerEvents = 'none';
          particle.style.zIndex = '2000';
          particle.style.left = (window.innerWidth / 2 (Math.random() - 0.5) * 100) 'px';
          particle.style.top = (window.innerHeight / 2 (Math.random() - 0.5) * 100) 'px';
          
          const animation = particle.animate([
            { transform: 'scale(1) translateY(0px)', opacity: 1 },
            { transform: 'scale(0) translateY(-200px)', opacity: 0 }
          ], {
            duration: 2000,
            easing: 'ease-out'
          });
          
          animation.onfinish = () => particle.remove();
          document.body.appendChild(particle);
        },  i +* 50);
      }
    }

    // Leveling System
    function addEXP(amount) {
      gameData.exp = amount;
      const expNeeded = gameData.level * 100;
      
      if (gameData.exp >= expNeeded) {
        gameData.level;
        gameData.exp = 0;
        showNotification(`üéâ Level Up! You are now level ${gameData.level}!`);
        
        // Level up rewards
        gameData.luckTokens = Math.floor(gameData.level / 5);
        gameData.balance = gameData.level * 50;
      }
    }

    // Enhanced AFK System
    function updateAFKIncome() {
      const now = Date.now();
      const timeDiff = now - gameData.lastAFKClaim;
      const hoursElapsed = timeDiff / (1000 * 60 * 60);
      
      if (hoursElapsed >= 0.5) { // Every 30 minutes
        const income = gameData.premium ? 2 : 1;
        const totalIncome = Math.floor(hoursElapsed * 2) * income;
        
        if (totalIncome > 0) {
          gameData.balance = totalIncome;
          gameData.lastAFKClaim = now;
          showNotification(`üí∞ AFK Income: $${totalIncome}`);
          updateUI();
          saveGameData();
        }
      }
    }

    // Initialize enhanced systems
    function initGame() {
      loadGameData();
      generateCases();
      generateVaultCases();
      generateQuests();
      generateAchievements();
      generateMarketplace();
      generateLeaderboard();
      generateDailyRewards();
      generateFusionSlots();
      populateBattleCases();
      updateUI();
      updateNetWorthRank();
      startAFKTimer();
      checkEventCases();
      checkDailyReset();
      setTheme(gameData.theme);
      
      // Check AFK income every minute
      setInterval(updateAFKIncome, 60000);
      
      // Auto-save every 30 seconds
      setInterval(saveGameData, 30000);
    }

    // Auto-save every 30 seconds
    setInterval(saveGameData, 30000);

    // Initialize game when page loads
    window.onload = initGame;
    window.onbeforeunload = saveGameData;
  </script>
</body>
</html>

EOF
)
