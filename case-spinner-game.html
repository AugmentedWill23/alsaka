<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Spinner Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.4);
            padding: 20px 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 4s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .stats {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .stat {
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }

        .premium-badge {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #000;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .main-nav {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .screen {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .case-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .case-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            backdrop-filter: blur(10px);
        }

        .case-card:hover {
            transform: translateY(-5px);
            border-color: #4ecdc4;
            box-shadow: 0 15px 35px rgba(78, 205, 196, 0.3);
        }

        .case-image {
            width: 120px;
            height: 120px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 15px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .case-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .case-price {
            color: #4ecdc4;
            font-size: 16px;
            font-weight: bold;
        }

        .spinner-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
        }

        .spinner-wheel {
            width: 400px;
            height: 400px;
            border: 8px solid #333;
            border-radius: 50%;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            background: conic-gradient(
                #ffffff 0deg 45deg,
                #3498db 45deg 90deg,
                #9b59b6 90deg 135deg,
                #e91e63 135deg 180deg,
                #f44336 180deg 225deg,
                #ff9800 225deg 270deg,
                #ffd700 270deg 315deg,
                #000000 315deg 360deg
            );
        }

        .spinner-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ff6b6b;
            z-index: 10;
        }

        .spin-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border: none;
            color: white;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s ease;
        }

        .spin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }

        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        .skin-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .skin-item:hover {
            transform: translateY(-3px);
            border-color: #4ecdc4;
        }

        .skin-icon {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .rarity-white { background: linear-gradient(45deg, #ffffff, #f8f9fa); color: #333; }
        .rarity-blue { background: linear-gradient(45deg, #3498db, #2980b9); }
        .rarity-purple { background: linear-gradient(45deg, #9b59b6, #8e44ad); }
        .rarity-pink { background: linear-gradient(45deg, #e91e63, #c2185b); }
        .rarity-red { background: linear-gradient(45deg, #f44336, #d32f2f); }
        .rarity-yellow { background: linear-gradient(45deg, #ff9800, #f57c00); }
        .rarity-golden { background: linear-gradient(45deg, #ffd700, #ffb300); }
        .rarity-black { background: linear-gradient(45deg, #000000, #424242); }

        .skin-name {
            font-size: 12px;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .skin-value {
            font-size: 14px;
            font-weight: bold;
            color: #4ecdc4;
        }

        .marketplace-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .marketplace-item .skin-icon {
            margin: 0;
        }

        .item-info {
            flex: 1;
        }

        .item-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .item-price {
            color: #4ecdc4;
            font-size: 18px;
            font-weight: bold;
        }

        .buy-btn {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .buy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
        }

        .battle-arena {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
        }

        .battle-opponents {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .opponent-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .opponent-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
        }

        .quest-list {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .quest-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .quest-progress {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .quest-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .clan-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin-bottom: 20px;
        }

        .clan-banner {
            width: 100px;
            height: 100px;
            border-radius: 15px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }

        .leaderboard-table {
            width: 100%;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
        }

        .leaderboard-table th,
        .leaderboard-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leaderboard-table th {
            background: rgba(0, 0, 0, 0.3);
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 2px solid #4ecdc4;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .reward-animation {
            animation: rewardPulse 2s ease-in-out;
        }

        @keyframes rewardPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            pointer-events: none;
            animation: particle 2s ease-out forwards;
        }

        @keyframes particle {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0) translateY(-100px);
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1001;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.2);
        }

        .afk-timer {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            text-align: center;
        }

        .timer-display {
            font-size: 24px;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 10px;
        }

        .daily-reward-day {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .daily-reward-day.claimed {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.2);
        }

        .daily-reward-day.current {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.2);
        }

        .fusion-slot {
            width: 80px;
            height: 80px;
            border: 3px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .fusion-slot.filled {
            border-style: solid;
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.2);
        }

        .fusion-slot:hover {
            border-color: #ff6b6b;
        }

        .achievement-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid transparent;
        }

        .achievement-item.completed {
            border-left-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }

        .achievement-item.claimed {
            opacity: 0.6;
            border-left-color: #666;
        }

        .event-timer {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 5px;
        }

        .pity-counter {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            margin-top: 5px;
        }

        .rarity-event { 
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #ffd700, #9b59b6); 
            background-size: 400% 400%;
            animation: rainbowShift 3s ease-in-out infinite;
        }

        @keyframes rainbowShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .sound-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            color: white;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            z-index: 1000;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .stats {
                gap: 15px;
                flex-wrap: wrap;
            }
            
            .spinner-wheel {
                width: 300px;
                height: 300px;
            }
            
            .case-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .inventory-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }

            .main-nav {
                gap: 8px;
            }

            .nav-btn {
                padding: 12px 15px;
                font-size: 14px;
                min-width: 100px;
            }
        }
    </style>
</head>
<body>
    <button class="sound-toggle" onclick="toggleSound()" id="sound-toggle">🔊</button>
    
    <div class="container">
        <header class="header">
            <div class="logo">🎰 Case Spinner Pro</div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Balance</div>
                    <div class="stat-value" id="balance">$5,000</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Net Worth</div>
                    <div class="stat-value" id="networth">$5,000</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Luck Tokens</div>
                    <div class="stat-value" id="tokens">3</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Vault Keys</div>
                    <div class="stat-value" id="vault-keys">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Fragments</div>
                    <div class="stat-value" id="fragments">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Rank</div>
                    <div class="stat-value" id="rank" style="color: #CD7F32;">Bronze</div>
                </div>
                <div class="premium-badge" id="premium-status">Premium</div>
            </div>
        </header>

        <nav class="main-nav">
            <button class="nav-btn active" onclick="showScreen('cases')">Cases</button>
            <button class="nav-btn" onclick="showScreen('inventory')">Inventory</button>
            <button class="nav-btn" onclick="showScreen('marketplace')">Marketplace</button>
            <button class="nav-btn" onclick="showScreen('battles')">Battles</button>
            <button class="nav-btn" onclick="showScreen('premium')">Premium</button>
            <button class="nav-btn" onclick="showScreen('vault')">Obsidian Vault</button>
            <button class="nav-btn" onclick="showScreen('quests')">Quests</button>
            <button class="nav-btn" onclick="showScreen('achievements')">Achievements</button>
            <button class="nav-btn" onclick="showScreen('fusion')">Fusion</button>
            <button class="nav-btn" onclick="showScreen('dailyrewards')">Daily</button>
            <button class="nav-btn" onclick="showScreen('clans')">Clans</button>
            <button class="nav-btn" onclick="showScreen('leaderboards')">Rankings</button>
        </nav>

        <!-- Cases Screen -->
        <div id="cases" class="screen active">
            <div class="afk-timer">
                <div class="timer-display" id="afk-timer">29:45</div>
                <div>Next AFK reward in</div>
                <button class="buy-btn" onclick="claimAFK()" id="claim-afk" style="display:none;">Claim $1</button>
            </div>

            <div class="case-grid" id="case-grid">
                <!-- Cases will be generated by JavaScript -->
            </div>
        </div>

        <!-- Inventory Screen -->
        <div id="inventory" class="screen">
            <div class="filters">
                <button class="filter-btn active" onclick="filterInventory('all')">All</button>
                <button class="filter-btn" onclick="filterInventory('white')">White</button>
                <button class="filter-btn" onclick="filterInventory('blue')">Blue</button>
                <button class="filter-btn" onclick="filterInventory('purple')">Purple</button>
                <button class="filter-btn" onclick="filterInventory('pink')">Pink</button>
                <button class="filter-btn" onclick="filterInventory('red')">Red</button>
                <button class="filter-btn" onclick="filterInventory('yellow')">Yellow</button>
                <button class="filter-btn" onclick="filterInventory('golden')">Golden</button>
                <button class="filter-btn" onclick="filterInventory('black')">Black</button>
            </div>
            <div class="inventory-grid" id="inventory-grid">
                <!-- Inventory items will be generated by JavaScript -->
            </div>
        </div>

        <!-- Marketplace Screen -->
        <div id="marketplace" class="screen">
            <h2 style="margin-bottom: 20px;">🏪 Marketplace</h2>
            <div id="marketplace-listings">
                <!-- Marketplace items will be generated by JavaScript -->
            </div>
        </div>

        <!-- Battles Screen -->
        <div id="battles" class="screen">
            <div class="battle-arena">
                <h2 style="margin-bottom: 20px;">⚔️ Case Battles</h2>
                <div class="battle-opponents" id="battle-opponents">
                    <!-- Battle opponents will be generated by JavaScript -->
                </div>
                <button class="spin-btn" onclick="startBattle()">Start Battle ($500)</button>
            </div>
        </div>

        <!-- Premium Screen -->
        <div id="premium" class="screen">
            <div class="clan-card">
                <h2>💎 Premium Pass</h2>
                <p style="margin: 20px 0;">Unlock exclusive benefits:</p>
                <ul style="text-align: left; margin: 20px 0;">
                    <li>🚀 Faster spin animations</li>
                    <li>💰 Double AFK income ($2/hour)</li>
                    <li>🎁 Extra free case daily</li>
                    <li>🍀 Hourly luck tokens</li>
                    <li>🏪 Reduced marketplace fees</li>
                </ul>
                <button class="spin-btn" onclick="togglePremium()">Toggle Premium</button>
            </div>
        </div>

        <!-- Obsidian Vault Screen -->
        <div id="vault" class="screen">
            <div style="background: linear-gradient(135deg, #2c1810, #1a0f08); border-radius: 20px; padding: 30px; margin: 20px 0; border: 3px solid #8b4513; box-shadow: 0 0 30px rgba(139, 69, 19, 0.5);">
                <h2 style="color: #ffd700; margin-bottom: 20px;">🏛️ OBSIDIAN VAULT EVENT</h2>
                <p style="margin-bottom: 20px;">Exclusive event lasting until September 30th, 2024!</p>
                <div style="background: linear-gradient(45deg, #ffd700, #ffb300); color: #000; padding: 15px 25px; border-radius: 15px; font-size: 18px; font-weight: bold; margin: 20px 0; display: inline-block;">
                    Vault Keys: <span id="vault-key-count">0</span> 🔑
                </div>
                <p style="margin: 20px 0;">Exchange 500 Luck Tokens for 1 Vault Key</p>
                <button style="background: linear-gradient(135deg, #8b4513, #a0522d); border: none; color: white; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; margin: 10px; transition: all 0.3s ease;" onclick="exchangeForVaultKey()" id="vault-exchange">
                    Exchange Tokens (500 → 1 Key)
                </button>
                <div style="margin: 30px 0;">
                    <h3>🎲 Roll for Vault Case</h3>
                    <p>Use 1 Vault Key to roll for a random vault case!</p>
                    <button style="background: linear-gradient(135deg, #8b4513, #a0522d); border: none; color: white; padding: 15px 30px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; margin: 10px; transition: all 0.3s ease;" onclick="rollVaultCase()" id="vault-roll" disabled>
                        Roll Vault Case (1 Key)
                    </button>
                </div>
                <div id="vault-cases" style="margin-top: 30px;">
                    <!-- Vault cases will be generated here -->
                </div>
            </div>
        </div>

        <!-- Quests Screen -->
        <div id="quests" class="screen">
            <h2 style="margin-bottom: 20px;">📋 Daily Quests</h2>
            <div class="quest-list" id="quest-list">
                <!-- Quests will be generated by JavaScript -->
            </div>
        </div>

        <!-- Clans Screen -->
        <div id="clans" class="screen">
            <div class="clan-card">
                <div class="clan-banner">🛡️</div>
                <h2 id="clan-name">Shadow Ops</h2>
                <p>Level 15 • 24 Members</p>
                <p style="margin: 15px 0;">Clan Goal: Open 10,000 cases together</p>
                <div class="quest-progress">
                    <div class="quest-progress-bar" style="width: 67%;"></div>
                </div>
                <p>6,700 / 10,000 cases opened</p>
                <button class="buy-btn" onclick="leaveClan()" style="margin-top: 15px;">Leave Clan</button>
            </div>
        </div>

        <!-- Achievements Screen -->
        <div id="achievements" class="screen">
            <h2 style="margin-bottom: 20px;">🏆 Achievements</h2>
            <div class="quest-list" id="achievement-list">
                <!-- Achievements will be generated by JavaScript -->
            </div>
        </div>

        <!-- Fusion Screen -->
        <div id="fusion" class="screen">
            <h2 style="margin-bottom: 20px;">⚗️ Skin Fusion</h2>
            <div class="clan-card">
                <h3>Fusion Workshop</h3>
                <p style="margin: 15px 0;">Combine 5 skins of the same rarity to create 1 skin of higher rarity!</p>
                <div id="fusion-slots" style="display: flex; gap: 10px; justify-content: center; margin: 20px 0;">
                    <!-- Fusion slots will be generated by JavaScript -->
                </div>
                <button class="spin-btn" onclick="performFusion()" id="fusion-btn" disabled>Fuse Skins</button>
                <div style="margin-top: 20px;">
                    <h4>Fragment Exchange</h4>
                    <p>Convert duplicate skins to fragments: <span id="fragment-count">0</span> fragments available</p>
                    <button class="buy-btn" onclick="convertDuplicates()">Convert Duplicates</button>
                </div>
            </div>
        </div>

        <!-- Daily Rewards Screen -->
        <div id="dailyrewards" class="screen">
            <h2 style="margin-bottom: 20px;">🎁 Daily Rewards</h2>
            <div class="clan-card">
                <h3>Daily Login Streak: <span id="streak-count">0</span> days</h3>
                <div id="daily-calendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 15px; margin: 20px 0;">
                    <!-- Daily reward calendar will be generated by JavaScript -->
                </div>
                <button class="spin-btn" onclick="claimDailyReward()" id="daily-claim-btn">Claim Today's Reward</button>
            </div>
        </div>

        <!-- Leaderboards Screen -->
        <div id="leaderboards" class="screen">
            <h2 style="margin-bottom: 20px;">🏆 Leaderboards</h2>
            <table class="leaderboard-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Player</th>
                        <th>Net Worth</th>
                        <th>Rarest Skin</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body">
                    <!-- Leaderboard data will be generated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Spinner Modal -->
    <div id="spinner-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeSpinner()">&times;</button>
            <h2 id="case-title">Opening Case...</h2>
            <div class="spinner-container">
                <div class="spinner-wheel" id="spinner-wheel">
                    <div class="spinner-pointer"></div>
                </div>
                <button class="spin-btn" id="spin-button" onclick="spinCase()">SPIN!</button>
            </div>
        </div>
    </div>

    <!-- Reward Modal -->
    <div id="reward-modal" class="modal">
        <div class="modal-content reward-animation">
            <button class="close-modal" onclick="closeReward()">&times;</button>
            <h2>🎉 Congratulations!</h2>
            <div class="skin-icon" id="reward-icon" style="width: 120px; height: 120px; margin: 20px auto; font-size: 48px;"></div>
            <h3 id="reward-name">Awesome Skin</h3>
            <p id="reward-value">Value: $1,234</p>
            <button class="buy-btn" onclick="closeReward()" style="margin-top: 20px;">Awesome!</button>
        </div>
    </div>

    <script>
        // Game Data Storage
        let gameData = {
            balance: 5,
            inventory: [],
            premium: false,
            luckTokens: 3,
            clan: "Shadow Ops",
            quests: {
                openCases: 0,
                battleWins: 0,
                marketTrades: 0,
                spendMoney: 0
            },
            achievements: [],
            afkTimer: 1800, // 30 minutes in seconds
            lastSave: Date.now(),
            pityCounter: {},
            dailyRewards: {
                lastClaim: 0,
                streak: 0,
                day: 1
            },
            netWorthRank: "Bronze",
            eventCases: {},
            fragments: 0,
            totalSpent: 0,
            casesOpened: 0,
            rarestPull: { name: "None", rarity: "white" },
            vaultKeys: 0,
            obsidianVaultUnlocked: false
        };

        // Expanded Skin Database with 800+ skins
        const skinDatabase = {
            white: [
                { name: "Basic Knife", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔪", value: 1 },
                { name: "Simple Pistol", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔫", value: 2 },
                { name: "Wood Stock", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🪵", value: 1 },
                { name: "Iron Sight", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🎯", value: 2 },
                { name: "Plain Grip", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=✋", value: 1 },
                { name: "Starter Blade", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=⚔️", value: 2 },
                { name: "Rookie Rifle", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🏹", value: 2 },
                { name: "Basic Scope", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔍", value: 1 },
                { name: "Training Sword", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🗡️", value: 1 },
                { name: "Novice Axe", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🪓", value: 2 },
                { name: "Rusty Blade", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔧", value: 1 },
                { name: "Worn Gloves", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🧤", value: 1 },
                { name: "Old Boot", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🥾", value: 1 },
                { name: "Cracked Shield", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🛡️", value: 2 },
                { name: "Bent Arrow", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🏹", value: 1 },
                { name: "Dull Spear", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🗡️", value: 1 },
                { name: "Wooden Club", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🏏", value: 1 },
                { name: "Stone Hammer", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔨", value: 2 },
                { name: "Leather Strap", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🎒", value: 1 },
                { name: "Iron Ring", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=💍", value: 1 },
                { name: "Cloth Bandage", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🩹", value: 1 },
                { name: "Wooden Stick", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🪄", value: 1 },
                { name: "Rope Coil", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🪢", value: 1 },
                { name: "Canvas Bag", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=👜", value: 1 },
                { name: "Metal Scrap", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=⚙️", value: 1 },
                { name: "Broken Chain", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=⛓️", value: 1 },
                { name: "Worn Hat", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🎩", value: 1 },
                { name: "Old Coin", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🪙", value: 1 },
                { name: "Torn Page", iron: "https://via.placeholder.com/80x80/ffffff/000000?text=📄", value: 1 },
                { name: "Dusty Bottle", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🍶", value: 1 },
                { name: "Faded Map", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🗺️", value: 1 },
                { name: "Chipped Mug", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=☕", value: 1 },
                { name: "Bent Fork", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🍴", value: 1 },
                { name: "Cracked Lens", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔍", value: 1 },
                { name: "Worn Shoe", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=👞", value: 1 },
                { name: "Old Key", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔑", value: 1 },
                { name: "Tattered Flag", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🏳️", value: 1 },
                { name: "Rusty Lock", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🔒", value: 1 },
                { name: "Broken Watch", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=⌚", value: 1 },
                { name: "Faded Photo", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=📷", value: 1 },
                { name: "Empty Vial", icon: "https://via.placeholder.com/80x80/ffffff/000000?text=🧪", value: 1 }
            ],
            blue: [
                { name: "Blue Steel", icon: "🗡️", value: 50 },
                { name: "Ocean Wave", icon: "🌊", value: 65 },
                { name: "Sky Hunter", icon: "☁️", value: 45 },
                { name: "Frost Bite", icon: "❄️", value: 70 },
                { name: "Sapphire Edge", icon: "💎", value: 80 },
                { name: "Arctic Wolf", icon: "🐺", value: 55 },
                { name: "Ice Shard", icon: "🧊", value: 62 },
                { name: "Storm Breaker", icon: "⛈️", value: 58 },
                { name: "Tidal Force", icon: "🌀", value: 72 },
                { name: "Glacier Strike", icon: "🏔️", value: 68 }
            ],
            purple: [
                { name: "Void Walker", icon: "👻", value: 150 },
                { name: "Mystic Blade", icon: "🔮", value: 180 },
                { name: "Purple Haze", icon: "🌙", value: 120 },
                { name: "Shadow Strike", icon: "⚡", value: 200 },
                { name: "Amethyst Claw", icon: "💜", value: 160 },
                { name: "Phantom Edge", icon: "👤", value: 175 },
                { name: "Cosmic Drift", icon: "🌌", value: 165 },
                { name: "Nebula Burst", icon: "💫", value: 190 },
                { name: "Spirit Blade", icon: "🌟", value: 155 },
                { name: "Twilight Fang", icon: "🦇", value: 185 }
            ],
            pink: [
                { name: "Rose Thorn", icon: "🌹", value: 400 },
                { name: "Flamingo Wing", icon: "🦩", value: 350 },
                { name: "Cherry Blossom", icon: "🌸", value: 450 },
                { name: "Sunset Blade", icon: "🌅", value: 380 },
                { name: "Neon Pink", icon: "💖", value: 420 },
                { name: "Sakura Storm", icon: "🌺", value: 390 },
                { name: "Bubblegum Pop", icon: "🍭", value: 410 },
                { name: "Cotton Candy", icon: "🍥", value: 370 },
                { name: "Peach Fury", icon: "🍑", value: 440 },
                { name: "Magenta Mayhem", icon: "🎀", value: 395 }
            ],
            red: [
                { name: "Blood Moon", icon: "🌙", value: 800 },
                { name: "Crimson Fury", icon: "🔥", value: 950 },
                { name: "Ruby Strike", icon: "💎", value: 750 },
                { name: "Phoenix Wing", icon: "🔥", value: 1100 },
                { name: "Inferno Blade", icon: "🌋", value: 900 },
                { name: "Dragon's Breath", icon: "🐉", value: 850 },
                { name: "Lava Flow", icon: "🌋", value: 920 },
                { name: "Scarlet Reaper", icon: "💀", value: 880 },
                { name: "Ember Strike", icon: "🔥", value: 970 },
                { name: "Crimson Crown", icon: "👑", value: 1050 }
            ],
            yellow: [
                { name: "Golden Tiger", icon: "🐅", value: 2000 },
                { name: "Lightning Bolt", icon: "⚡", value: 2200 },
                { name: "Solar Flare", icon: "☀️", value: 1800 },
                { name: "Banana Split", icon: "🍌", value: 2500 },
                { name: "Thunder Strike", icon: "⛈️", value: 2100 },
                { name: "Electric Storm", icon: "🌩️", value: 2300 },
                { name: "Golden Eagle", icon: "🦅", value: 1950 },
                { name: "Sunburst", icon: "🌞", value: 2150 },
                { name: "Lightning Rod", icon: "⚡", value: 2400 },
                { name: "Honey Badger", icon: "🦡", value: 1850 }
            ],
            golden: [
                { name: "Midas Touch", icon: "👑", value: 5000 },
                { name: "Golden Dragon", icon: "🐲", value: 5500 },
                { name: "Treasure Hunter", icon: "🏴‍☠️", value: 4800 },
                { name: "King's Crown", icon: "👑", value: 6000 },
                { name: "Golden Phoenix", icon: "🦅", value: 5200 },
                { name: "Gilded Serpent", icon: "🐍", value: 5300 },
                { name: "Royal Scepter", icon: "🪄", value: 5700 },
                { name: "Golden Lotus", icon: "🪷", value: 4900 },
                { name: "Emperor's Blade", icon: "⚔️", value: 5800 },
                { name: "Golden Kraken", icon: "🐙", value: 5400 }
            ],
            black: [
                { name: "Obsidian Karambit", icon: "🖤", value: 15000 },
                { name: "Void Emperor", icon: "👑", value: 18000 },
                { name: "Shadow Legend", icon: "🌑", value: 12000 },
                { name: "Dark Matter", icon: "⚫", value: 20000 },
                { name: "Nightmare Blade", icon: "😈", value: 16000 },
                { name: "Abyssal Crown", icon: "👑", value: 22000 },
                { name: "Eclipse Edge", icon: "🌘", value: 14000 },
                { name: "Void Reaper", icon: "💀", value: 19000 },
                { name: "Shadow King", icon: "👤", value: 17000 },
                { name: "Dark Phoenix", icon: "🦅", value: 21000 }
            ],
            // Event-exclusive skins
            event: [
                { name: "Halloween Pumpkin", icon: "🎃", value: 3000, event: "Halloween", unsellable: true },
                { name: "Christmas Star", icon: "⭐", value: 3500, event: "Christmas", unsellable: true },
                { name: "Valentine Heart", icon: "💝", value: 2800, event: "Valentine", unsellable: true },
                { name: "Easter Bunny", icon: "🐰", value: 3200, event: "Easter", unsellable: true },
                { name: "Summer Sun", icon: "🌞", value: 2900, event: "Summer", unsellable: true }
            ],
            // Obsidian Vault Exclusive Rarities
            volcanic: Array.from({length: 15}, (_, i) => ({
                name: `Volcanic Obsidian ${['Inferno Blade', 'Magma Cannon', 'Lava Staff', 'Molten Hammer', 'Fire Bow', 'Ember Gauntlets', 'Flame Cloak', 'Volcano Crown', 'Burning Heart', 'Phoenix Core'][i % 10]}`,
                icon: `https://via.placeholder.com/80x80/ff4500/ffffff?text=VO${i + 1}`,
                value: Math.floor(Math.random() * 100000) + 100000
            })),
            obsidian: Array.from({length: 12}, (_, i) => ({
                name: `Pure Obsidian ${['Shadow Blade', 'Void Cannon', 'Dark Staff', 'Night Hammer', 'Eclipse Bow', 'Darkness Gauntlets', 'Midnight Cloak', 'Obsidian Crown', 'Black Heart', 'Void Core'][i % 10]}`,
                icon: `https://via.placeholder.com/80x80/2f2f2f/ffffff?text=PO${i + 1}`,
                value: Math.floor(Math.random() * 75000) + 75000
            })),
            shattered: Array.from({length: 10}, (_, i) => ({
                name: `Shattered Obsidian ${['Broken Blade', 'Cracked Cannon', 'Split Staff', 'Fractured Hammer', 'Torn Bow', 'Shattered Gauntlets', 'Ripped Cloak', 'Cracked Crown', 'Broken Heart', 'Split Core'][i % 10]}`,
                icon: `https://via.placeholder.com/80x80/666666/ffffff?text=SO${i + 1}`,
                value: Math.floor(Math.random() * 50000) + 50000
            }))
        };

        // Expanded Case Database with 60+ cases
        const caseDatabase = [
            // Basic Cases (Properly balanced)
            { name: "Starter Case", icon: "https://via.placeholder.com/120x120/cccccc/000000?text=START", price: 5, drops: { white: 0.89, blue: 0.10, purple: 0.009, pink: 0.0009, red: 0.00009, shattered: 0.00000001 } },
            { name: "Common Case", icon: "https://via.placeholder.com/120x120/ffffff/000000?text=COMMON", price: 25, drops: { white: 0.78, blue: 0.18, purple: 0.035, pink: 0.0045, red: 0.0004, yellow: 0.00009, obsidian: 0.00000002, shattered: 0.0000001 } },
            { name: "Basic Case", icon: "https://via.placeholder.com/120x120/e0e0e0/000000?text=BASIC", price: 75, drops: { white: 0.65, blue: 0.28, purple: 0.06, pink: 0.009, red: 0.0009, yellow: 0.0001, obsidian: 0.00000005, shattered: 0.0000001 } },
            { name: "Rare Case", icon: "https://via.placeholder.com/120x120/3498db/ffffff?text=RARE", price: 200, drops: { white: 0.50, blue: 0.35, purple: 0.12, pink: 0.025, red: 0.004, yellow: 0.0009, golden: 0.00009, obsidian: 0.00000005, shattered: 0.0000001 } },
            { name: "Superior Case", icon: "https://via.placeholder.com/120x120/5dade2/ffffff?text=SUPER", price: 500, drops: { blue: 0.45, purple: 0.35, pink: 0.15, red: 0.045, yellow: 0.004, golden: 0.0009, black: 0.00009, volcanic: 0.000000005, shattered: 0.0000001 } },
            { name: "Epic Case", icon: "https://via.placeholder.com/120x120/9b59b6/ffffff?text=EPIC", price: 1200, drops: { blue: 0.30, purple: 0.40, pink: 0.22, red: 0.07, yellow: 0.007, golden: 0.002, black: 0.0009, volcanic: 0.000000005, shattered: 0.0000001 } },
            { name: "Elite Case", icon: "https://via.placeholder.com/120x120/8e44ad/ffffff?text=ELITE", price: 3000, drops: { purple: 0.35, pink: 0.35, red: 0.22, yellow: 0.07, golden: 0.009, black: 0.0009, volcanic: 0.00000001, obsidian: 0.00000002 } },
            { name: "Legendary Case", icon: "https://via.placeholder.com/120x120/e91e63/ffffff?text=LEGEND", price: 7500, drops: { purple: 0.25, pink: 0.40, red: 0.25, yellow: 0.08, golden: 0.019, black: 0.0009, volcanic: 0.00000001, obsidian: 0.00000002 } },
            { name: "Master Case", icon: "https://via.placeholder.com/120x120/c2185b/ffffff?text=MASTER", price: 15000, drops: { pink: 0.30, red: 0.40, yellow: 0.20, golden: 0.08, black: 0.019, volcanic: 0.0000001, obsidian: 0.0000005 } },
            { name: "Mythical Case", icon: "https://via.placeholder.com/120x120/f44336/ffffff?text=MYTH", price: 35000, drops: { pink: 0.20, red: 0.45, yellow: 0.25, golden: 0.08, black: 0.019, volcanic: 0.0000001, obsidian: 0.0000005 } },
            { name: "Ancient Case", icon: "https://via.placeholder.com/120x120/ff9800/ffffff?text=ANCIENT", price: 75000, drops: { red: 0.30, yellow: 0.40, golden: 0.25, black: 0.049, volcanic: 0.000001, obsidian: 0.000004 } },
            { name: "Divine Case", icon: "https://via.placeholder.com/120x120/ff5722/ffffff?text=DIVINE", price: 150000, drops: { red: 0.15, yellow: 0.45, golden: 0.35, black: 0.049, volcanic: 0.000001, obsidian: 0.000004 } },
            { name: "Golden Case", icon: "https://via.placeholder.com/120x120/ffd700/000000?text=GOLD", price: 300000, drops: { yellow: 0.35, golden: 0.50, black: 0.149, volcanic: 0.000001, obsidian: 0.000003 } },
            { name: "Supreme Case", icon: "https://via.placeholder.com/120x120/f39c12/000000?text=SUPREME", price: 600000, drops: { yellow: 0.20, golden: 0.60, black: 0.199, volcanic: 0.000001, obsidian: 0.000003 } },
            { name: "Immortal Case", icon: "https://via.placeholder.com/120x120/000000/ffffff?text=IMMORTAL", price: 1000000, drops: { golden: 0.50, black: 0.499, volcanic: 0.000001, obsidian: 0.000003 } },
            
            // Themed Cases (25 total themed cases)
            { name: "Fire Case", icon: "https://via.placeholder.com/120x120/ff4500/ffffff?text=FIRE", price: 800, drops: { blue: 0.30, purple: 0.30, pink: 0.25, red: 0.13, yellow: 0.019, golden: 0.0009, volcanic: 0.000001 } },
            { name: "Inferno Case", icon: "https://via.placeholder.com/120x120/dc143c/ffffff?text=INFERNO", price: 2500, drops: { purple: 0.25, pink: 0.30, red: 0.30, yellow: 0.13, golden: 0.019, black: 0.0009, volcanic: 0.000001 } },
            { name: "Ice Case", icon: "https://via.placeholder.com/120x120/87ceeb/000000?text=ICE", price: 800, drops: { blue: 0.35, purple: 0.30, pink: 0.20, red: 0.13, yellow: 0.019, golden: 0.0009, shattered: 0.000001 } },
            { name: "Frost Case", icon: "https://via.placeholder.com/120x120/4682b4/ffffff?text=FROST", price: 2500, drops: { purple: 0.25, pink: 0.30, red: 0.30, yellow: 0.13, golden: 0.019, black: 0.0009, shattered: 0.000001 } },
            { name: "Lightning Case", icon: "https://via.placeholder.com/120x120/ffff00/000000?text=BOLT", price: 1500, drops: { purple: 0.25, pink: 0.30, red: 0.25, yellow: 0.18, golden: 0.019, black: 0.0009, volcanic: 0.000001 } },
            { name: "Storm Case", icon: "https://via.placeholder.com/120x120/4169e1/ffffff?text=STORM", price: 4000, drops: { pink: 0.20, red: 0.30, yellow: 0.30, golden: 0.18, black: 0.019, volcanic: 0.000001 } },
            { name: "Earth Case", icon: "https://via.placeholder.com/120x120/8b4513/ffffff?text=EARTH", price: 1200, drops: { purple: 0.30, pink: 0.25, red: 0.25, yellow: 0.18, golden: 0.019, black: 0.0009, shattered: 0.000001 } },
            { name: "Nature Case", icon: "https://via.placeholder.com/120x120/228b22/ffffff?text=NATURE", price: 3500, drops: { pink: 0.25, red: 0.25, yellow: 0.30, golden: 0.18, black: 0.019, obsidian: 0.000001 } },
            { name: "Shadow Case", icon: "https://via.placeholder.com/120x120/2f2f2f/ffffff?text=SHADOW", price: 5000, drops: { purple: 0.20, pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.08, black: 0.019, obsidian: 0.000001 } },
            { name: "Darkness Case", icon: "https://via.placeholder.com/120x120/1c1c1c/ffffff?text=DARK", price: 12000, drops: { pink: 0.15, red: 0.25, yellow: 0.30, golden: 0.25, black: 0.049, obsidian: 0.000001 } },
            { name: "Light Case", icon: "https://via.placeholder.com/120x120/fffacd/000000?text=LIGHT", price: 5000, drops: { purple: 0.20, pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.08, black: 0.019, obsidian: 0.000001 } },
            { name: "Radiance Case", icon: "https://via.placeholder.com/120x120/fff8dc/000000?text=RADIANT", price: 12000, drops: { pink: 0.15, red: 0.25, yellow: 0.30, golden: 0.25, black: 0.049, volcanic: 0.000001 } },
            { name: "Crystal Case", icon: "https://via.placeholder.com/120x120/ff69b4/ffffff?text=CRYSTAL", price: 8000, drops: { pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.22, black: 0.029, shattered: 0.000001 } },
            { name: "Diamond Case", icon: "https://via.placeholder.com/120x120/b0c4de/000000?text=DIAMOND", price: 20000, drops: { red: 0.20, yellow: 0.30, golden: 0.35, black: 0.149, shattered: 0.000001 } },
            { name: "Demon Case", icon: "https://via.placeholder.com/120x120/8b0000/ffffff?text=DEMON", price: 15000, drops: { red: 0.25, yellow: 0.30, golden: 0.30, black: 0.149, volcanic: 0.000001 } },
            { name: "Devil Case", icon: "https://via.placeholder.com/120x120/660000/ffffff?text=DEVIL", price: 40000, drops: { yellow: 0.25, golden: 0.40, black: 0.349, volcanic: 0.000001 } },
            { name: "Angel Case", icon: "https://via.placeholder.com/120x120/ffffff/000000?text=ANGEL", price: 15000, drops: { red: 0.20, yellow: 0.30, golden: 0.35, black: 0.149, obsidian: 0.000001 } },
            { name: "Celestial Case", icon: "https://via.placeholder.com/120x120/f0f8ff/000000?text=CELESTIAL", price: 40000, drops: { yellow: 0.25, golden: 0.40, black: 0.349, obsidian: 0.000001 } },
            { name: "Dragon Case", icon: "https://via.placeholder.com/120x120/ff6347/ffffff?text=DRAGON", price: 50000, drops: { yellow: 0.20, golden: 0.45, black: 0.349, volcanic: 0.000001 } },
            { name: "Phoenix Case", icon: "https://via.placeholder.com/120x120/ff1493/ffffff?text=PHOENIX", price: 80000, drops: { golden: 0.50, black: 0.499, volcanic: 0.000001, obsidian: 0.000003 } },
            { name: "Titan Case", icon: "https://via.placeholder.com/120x120/708090/ffffff?text=TITAN", price: 60000, drops: { yellow: 0.25, golden: 0.40, black: 0.349, shattered: 0.000001 } },
            { name: "God Case", icon: "https://via.placeholder.com/120x120/daa520/000000?text=GOD", price: 200000, drops: { golden: 0.60, black: 0.399, volcanic: 0.0005, obsidian: 0.0005 } },
            { name: "Void Case", icon: "https://via.placeholder.com/120x120/4b0082/ffffff?text=VOID", price: 150000, drops: { golden: 0.30, black: 0.699, volcanic: 0.0005, obsidian: 0.0005 } },
            { name: "Cosmic Case", icon: "https://via.placeholder.com/120x120/191970/ffffff?text=COSMIC", price: 400000, drops: { black: 0.995, volcanic: 0.002, obsidian: 0.003 } },
            { name: "Universe Case", icon: "https://via.placeholder.com/120x120/000080/ffffff?text=UNIVERSE", price: 800000, drops: { black: 0.99, volcanic: 0.005, obsidian: 0.005 } },
            
            // Premium Cases
            { name: "VIP Vault", icon: "https://via.placeholder.com/120x120/ffd700/000000?text=VIP", price: 10000, premiumOnly: true, drops: { red: 0.15, yellow: 0.30, golden: 0.40, black: 0.149, volcanic: 0.0005, obsidian: 0.0005 } },
            { name: "Elite Vault", icon: "https://via.placeholder.com/120x120/b8860b/ffffff?text=ELITE", price: 50000, premiumOnly: true, drops: { yellow: 0.20, golden: 0.50, black: 0.299, volcanic: 0.0005, obsidian: 0.0005 } },
            { name: "Supreme Vault", icon: "https://via.placeholder.com/120x120/8b4513/ffffff?text=SUPREME", price: 200000, premiumOnly: true, drops: { golden: 0.40, black: 0.599, volcanic: 0.0005, obsidian: 0.0005 } },
            { name: "Ultimate Vault", icon: "https://via.placeholder.com/120x120/654321/ffffff?text=ULTIMATE", price: 500000, premiumOnly: true, drops: { golden: 0.30, black: 0.699, volcanic: 0.0005, obsidian: 0.0005 } },
            { name: "Infinite Vault", icon: "https://via.placeholder.com/120x120/2f1b14/ffffff?text=INFINITE", price: 1000000, premiumOnly: true, drops: { black: 0.995, volcanic: 0.002, obsidian: 0.003 } },
            
            // Event Cases
            { name: "Halloween Case", icon: "https://via.placeholder.com/120x120/ff8c00/000000?text=🎃", price: 666, isEvent: true, eventEnd: Date.now() + (60 * 24 * 60 * 60 * 1000), drops: { purple: 0.20, pink: 0.25, red: 0.30, yellow: 0.20, golden: 0.049, black: 0.0009, shattered: 0.000001 } },
            { name: "Christmas Case", icon: "https://via.placeholder.com/120x120/228b22/ffffff?text=🎄", price: 777, isEvent: true, eventEnd: Date.now() + (90 * 24 * 60 * 60 * 1000), drops: { purple: 0.15, pink: 0.25, red: 0.30, yellow: 0.25, golden: 0.049, black: 0.0009, obsidian: 0.000001 } },
            { name: "Valentine Case", icon: "https://via.placeholder.com/120x120/ff1493/ffffff?text=💝", price: 999, isEvent: true, eventEnd: Date.now() + (45 * 24 * 60 * 60 * 1000), drops: { purple: 0.15, pink: 0.30, red: 0.30, yellow: 0.20, golden: 0.049, black: 0.0009, volcanic: 0.000001 } },
            { name: "Easter Case", icon: "https://via.placeholder.com/120x120/98fb98/000000?text=🐰", price: 888, isEvent: true, eventEnd: Date.now() + (30 * 24 * 60 * 60 * 1000), drops: { purple: 0.20, pink: 0.25, red: 0.25, yellow: 0.25, golden: 0.049, black: 0.0009, shattered: 0.000001 } },
            
            // Obsidian Vault Cases (unlocked with vault keys) - Available in marketplace with extreme prices
            { name: "Shattered Obsidian Vault", icon: "https://via.placeholder.com/120x120/666666/ffffff?text=SHARD", price: 0, isVaultCase: true, vaultTier: 3, marketPrice: 5000000, drops: { black: 0.60, shattered: 0.40 } },
            { name: "Obsidian Vault", icon: "https://via.placeholder.com/120x120/2f2f2f/ffffff?text=OBSID", price: 0, isVaultCase: true, vaultTier: 2, marketPrice: 15000000, drops: { black: 0.40, obsidian: 0.60 } },
            { name: "Volcanic Obsidian Vault", icon: "https://via.placeholder.com/120x120/ff4500/ffffff?text=VOLC", price: 0, isVaultCase: true, vaultTier: 1, marketPrice: 50000000, drops: { black: 0.20, volcanic: 0.80 } }
        ];

        // Daily Rewards
        const dailyRewards = [
            { day: 1, reward: 10, type: "currency" },
            { day: 2, reward: 1, type: "tokens" },
            { day: 3, reward: 25, type: "currency" },
            { day: 4, reward: 2, type: "tokens" },
            { day: 5, reward: 50, type: "currency" },
            { day: 6, reward: 3, type: "tokens" },
            { day: 7, reward: 100, type: "currency" }
        ];

        // Initialize Game
        function initGame() {
            loadGameData();
            generateCases();
            generateVaultCases();
            generateQuests();
            generateAchievements();
            generateMarketplace();
            generateLeaderboard();
            generateDailyRewards();
            updateUI();
            startAFKTimer();
            checkVaultExpiry();
            
            // Update timers every minute
            setInterval(() => {
                updateDailyRewardTimer();
                updateUI();
            }, 60000);
        }

        // Exchange Tokens for Vault Key
        function exchangeForVaultKey() {
            if (gameData.luckTokens < 500) {
                showNotification("You need 500 Luck Tokens to exchange for a Vault Key!");
                return;
            }
            
            gameData.luckTokens -= 500;
            gameData.vaultKeys++;
            
            showNotification("Exchanged 500 Luck Tokens for 1 Vault Key!");
            updateUI();
            saveGameData();
        }

        // Roll Vault Case
        function rollVaultCase() {
            if (gameData.vaultKeys < 1) {
                showNotification("You need at least 1 Vault Key!");
                return;
            }
            
            gameData.vaultKeys--;
            
            // Random roll for vault case (weighted towards lower tiers)
            const roll = Math.random();
            let selectedCase;
            
            if (roll < 0.60) {
                // 60% chance for Tier 3 (Shattered)
                selectedCase = caseDatabase.find(c => c.vaultTier === 3);
            } else if (roll < 0.90) {
                // 30% chance for Tier 2 (Obsidian)
                selectedCase = caseDatabase.find(c => c.vaultTier === 2);
            } else {
                // 10% chance for Tier 1 (Volcanic)
                selectedCase = caseDatabase.find(c => c.vaultTier === 1);
            }
            
            showNotification(`🎲 Rolled ${selectedCase.name}! Opening now...`);
            
            setTimeout(() => {
                document.getElementById('case-title').textContent = `Opening ${selectedCase.name}...`;
                document.getElementById('spinner-modal').style.display = 'block';
                window.currentCase = selectedCase;
            }, 1000);
            
            updateUI();
            saveGameData();
        }

        // Generate Vault Cases
        function generateVaultCases() {
            const vaultContainer = document.getElementById('vault-cases');
            if (!vaultContainer) return;
            
            // Check if vault event is still active
            const vaultEndDate = new Date('2024-09-30');
            const now = new Date();
            
            if (now > vaultEndDate) {
                vaultContainer.innerHTML = '<p style="color: #ff6b6b; font-size: 18px;">Obsidian Vault Event has ended!</p>';
                return;
            }
            
            vaultContainer.innerHTML = '<h3 style="margin-bottom: 20px;">Vault Cases (Requires Vault Keys)</h3>';
            
            const vaultCases = caseDatabase.filter(c => c.isVaultCase).sort((a, b) => a.vaultTier - b.vaultTier);
            
            vaultCases.forEach((caseData, index) => {
                const caseCard = document.createElement('div');
                caseCard.className = 'case-card';
                caseCard.style.border = `3px solid ${caseData.vaultTier === 1 ? '#ff4500' : caseData.vaultTier === 2 ? '#2f2f2f' : '#666666'}`;
                
                caseCard.innerHTML = `
                    <div class="case-image">
                        <img src="${caseData.icon}" alt="${caseData.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 15px;">
                    </div>
                    <div class="case-name">${caseData.name}</div>
                    <div class="case-price">1 Vault Key 🔑</div>
                    <div style="font-size: 12px; margin-top: 10px;">Tier ${caseData.vaultTier} (${caseData.vaultTier === 1 ? 'Best' : caseData.vaultTier === 2 ? 'Great' : 'Good'})</div>
                `;
                caseCard.onclick = () => openVaultCase(caseData);
                vaultContainer.appendChild(caseCard);
            });
        }

        // Open Vault Case
        function openVaultCase(caseData) {
            if (gameData.vaultKeys < 1) {
                showNotification("You need a Vault Key to open this case!");
                return;
            }
            
            gameData.vaultKeys--;
            
            document.getElementById('case-title').textContent = `Opening ${caseData.name}...`;
            document.getElementById('spinner-modal').style.display = 'block';
            
            window.currentCase = caseData;
            updateUI();
            saveGameData();
        }

        // Check Vault Expiry
        function checkVaultExpiry() {
            const vaultEndDate = new Date('2024-09-30');
            const now = new Date();
            
            if (now > vaultEndDate) {
                // Make obsidian vault skins sellable
                gameData.inventory.forEach(skin => {
                    if (['volcanic', 'obsidian', 'shattered'].includes(skin.rarity)) {
                        skin.sellable = true;
                    }
                });
                saveGameData();
            }
        }

        // Enhanced Update UI
        function updateUI() {
            document.getElementById('balance').textContent = `$${gameData.balance.toLocaleString()}`;
            document.getElementById('tokens').textContent = gameData.luckTokens.toLocaleString();
            document.getElementById('vault-keys').textContent = gameData.vaultKeys;
            document.getElementById('fragments').textContent = gameData.fragments;
            
            const inventoryValue = gameData.inventory.reduce((sum, skin) => sum + skin.value, 0);
            const netWorth = gameData.balance + inventoryValue;
            document.getElementById('networth').textContent = `$${netWorth.toLocaleString()}`;
            
            // Update rank
            const rank = getCurrentRank();
            document.getElementById('rank').textContent = rank.name;
            document.getElementById('rank').style.color = rank.color;
            
            document.getElementById('premium-status').textContent = gameData.premium ? 'Premium' : 'Free';
            document.getElementById('premium-status').style.background = gameData.premium 
                ? 'linear-gradient(45deg, #ffd700, #ffed4e)' 
                : 'rgba(255, 255, 255, 0.2)';
                
            // Update vault key count in vault screen
            const vaultKeyCount = document.getElementById('vault-key-count');
            if (vaultKeyCount) vaultKeyCount.textContent = gameData.vaultKeys;
            
            // Update exchange button
            const exchangeBtn = document.getElementById('vault-exchange');
            if (exchangeBtn) {
                exchangeBtn.disabled = gameData.luckTokens < 500;
                exchangeBtn.textContent = `Exchange Tokens (${gameData.luckTokens}/500 → 1 Key)`;
            }
            
            // Update roll button
            const rollBtn = document.getElementById('vault-roll');
            if (rollBtn) {
                rollBtn.disabled = gameData.vaultKeys < 1;
                rollBtn.textContent = `Roll Vault Case (${gameData.vaultKeys}/1 Key)`;
            }
        }
                icon: "👑",
                price: 1200,
                theme: "royal",
                drops: {
                    red: 0.3,
                    yellow: 0.25,
                    golden: 0.35,
                    black: 0.1
                }
            },
            // Event Cases (with timers)
            {
                name: "Halloween Case",
                icon: "🎃",
                price: 400,
                isEvent: true,
                eventEnd: Date.now() + (14 * 24 * 60 * 60 * 1000), // 2 weeks from now
                drops: {
                    purple: 0.3,
                    pink: 0.25,
                    red: 0.2,
                    yellow: 0.15,
                    golden: 0.08,
                    event: 0.02
                }
            },
            {
                name: "Christmas Case",
                icon: "🎄",
                price: 450,
                isEvent: true,
                eventEnd: Date.now() + (14 * 24 * 60 * 60 * 1000),
                drops: {
                    purple: 0.25,
                    pink: 0.3,
                    red: 0.2,
                    yellow: 0.15,
                    golden: 0.08,
                    event: 0.02
                }
            },
            // Premium-only cases
            {
                name: "VIP Vault",
                icon: "🔐",
                price: 800,
                premiumOnly: true,
                drops: {
                    pink: 0.3,
                    red: 0.25,
                    yellow: 0.2,
                    golden: 0.2,
                    black: 0.05
                }
            },
            {
                name: "Collector's Edition",
                icon: "💼",
                price: 1500,
                premiumOnly: true,
                drops: {
                    red: 0.25,
                    yellow: 0.25,
                    golden: 0.35,
                    black: 0.15
                }
            }
        ];

        // Net Worth Ranks
        const netWorthRanks = [
            { name: "Bronze", threshold: 0, color: "#CD7F32", perks: ["Basic AFK income"] },
            { name: "Silver", threshold: 10000, color: "#C0C0C0", perks: ["10% faster spins", "+1 daily quest"] },
            { name: "Gold", threshold: 50000, color: "#FFD700", perks: ["20% faster spins", "+2 daily quests", "5% marketplace discount"] },
            { name: "Diamond", threshold: 100000, color: "#B9F2FF", perks: ["30% faster spins", "+3 daily quests", "10% marketplace discount", "Extra luck token daily"] },
            { name: "Obsidian", threshold: 500000, color: "#36454F", perks: ["50% faster spins", "+5 daily quests", "20% marketplace discount", "+2 luck tokens daily", "Exclusive cases"] }
        ];

        // Achievement System
        const achievements = [
            { id: "first_case", name: "First Steps", description: "Open your first case", reward: 100, type: "currency", condition: "casesOpened", target: 1 },
            { id: "case_opener", name: "Case Opener", description: "Open 100 cases", reward: 1000, type: "currency", condition: "casesOpened", target: 100 },
            { id: "case_master", name: "Case Master", description: "Open 1000 cases", reward: 5000, type: "currency", condition: "casesOpened", target: 1000 },
            { id: "big_spender", name: "Big Spender", description: "Spend $10,000", reward: 3, type: "tokens", condition: "totalSpent", target: 10000 },
            { id: "millionaire", name: "Millionaire", description: "Reach $1,000,000 net worth", reward: 10000, type: "currency", condition: "networth", target: 1000000 },
            { id: "rare_collector", name: "Rare Collector", description: "Pull a Golden rarity skin", reward: 5, type: "tokens", condition: "rarest", target: "golden" },
            { id: "legend", name: "Legend", description: "Pull a Black rarity skin", reward: 10, type: "tokens", condition: "rarest", target: "black" },
            { id: "battle_winner", name: "Battle Winner", description: "Win 10 battles", reward: 2000, type: "currency", condition: "battleWins", target: 10 },
            { id: "trader", name: "Trader", description: "Make 50 trades", reward: 1500, type: "currency", condition: "marketTrades", target: 50 }
        ];

        // Daily Rewards Calendar
        const dailyRewards = [
            { day: 1, reward: 100, type: "currency" },
            { day: 2, reward: 1, type: "tokens" },
            { day: 3, reward: 200, type: "currency" },
            { day: 4, reward: 50, type: "fragments" },
            { day: 5, reward: 500, type: "currency" },
            { day: 6, reward: 2, type: "tokens" },
            { day: 7, reward: 1000, type: "currency" }
        ];

        // Quest Templates
        const questTemplates = [
            { id: "openCases", name: "Case Opener", description: "Open 10 cases", target: 10, reward: 500, type: "currency" },
            { id: "battleWins", name: "Battle Master", description: "Win 5 battles", target: 5, reward: 2, type: "tokens" },
            { id: "marketTrades", name: "Trader", description: "Make 3 marketplace trades", target: 3, reward: 1000, type: "currency" },
            { id: "spendMoney", name: "Big Spender", description: "Spend $2000", target: 2000, reward: 1, type: "tokens" }
        ];

        // Initialize Game
        function initGame() {
            loadGameData();
            generateCases();
            generateQuests();
            generateAchievements();
            generateMarketplace();
            generateLeaderboard();
            generateDailyRewards();
            generateFusionSlots();
            updateUI();
            updateNetWorthRank();
            startAFKTimer();
            checkEventCases();
            
            // Auto-save every 30 seconds
            setInterval(saveGameData, 30000);
            
            // Check for daily rewards reset
            checkDailyReset();
        }

        // Load/Save Game Data
        function loadGameData() {
            const saved = localStorage.getItem('caseSpinnerGame');
            if (saved) {
                gameData = { ...gameData, ...JSON.parse(saved) };
            }
        }

        function saveGameData() {
            gameData.lastSave = Date.now();
            localStorage.setItem('caseSpinnerGame', JSON.stringify(gameData));
        }

        // Screen Navigation
        function showScreen(screenName) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected screen
            document.getElementById(screenName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Update screen content
            if (screenName === 'inventory') {
                updateInventory();
            } else if (screenName === 'marketplace') {
                updateMarketplace();
            }
        }

        // Generate Cases
        function generateCases() {
            const caseGrid = document.getElementById('case-grid');
            caseGrid.innerHTML = '';
            
            caseDatabase.forEach((caseData, index) => {
                // Check if case is available
                if (caseData.premiumOnly && !gameData.premium) return;
                if (caseData.isEvent && Date.now() > caseData.eventEnd) return;
                
                const caseCard = document.createElement('div');
                caseCard.className = 'case-card';
                
                let eventTimer = '';
                if (caseData.isEvent) {
                    const timeLeft = caseData.eventEnd - Date.now();
                    const days = Math.floor(timeLeft / (24 * 60 * 60 * 1000));
                    const hours = Math.floor((timeLeft % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));
                    eventTimer = `<div class="event-timer">${days}d ${hours}h left</div>`;
                }
                
                let pityDisplay = '';
                const pityCount = gameData.pityCounter[caseData.name] || 0;
                if (pityCount > 0) {
                    pityDisplay = `<div class="pity-counter">Pity: ${pityCount}/50</div>`;
                }
                
                caseCard.innerHTML = `
                    <div class="case-image">${caseData.icon}</div>
                    <div class="case-name">${caseData.name}</div>
                    <div class="case-price">$${caseData.price}</div>
                    ${eventTimer}
                    ${pityDisplay}
                `;
                caseCard.onclick = () => openCase(index);
                caseGrid.appendChild(caseCard);
            });
        }

        // Open Case
        function openCase(caseIndex) {
            const caseData = caseDatabase[caseIndex];
            
            if (gameData.balance < caseData.price) {
                showNotification("Not enough balance!");
                return;
            }
            
            // Check premium requirement
            if (caseData.premiumOnly && !gameData.premium) {
                showNotification("Premium required for this case!");
                return;
            }
            
            gameData.balance -= caseData.price;
            gameData.quests.openCases++;
            gameData.totalSpent += caseData.price;
            gameData.casesOpened++;
            
            // Update pity counter
            if (!gameData.pityCounter[caseData.name]) {
                gameData.pityCounter[caseData.name] = 0;
            }
            gameData.pityCounter[caseData.name]++;
            
            document.getElementById('case-title').textContent = `Opening ${caseData.name}...`;
            document.getElementById('spinner-modal').style.display = 'block';
            
            // Store current case for spinning
            window.currentCase = caseData;
            updateUI();
            checkAchievements();
        }

        // Spin Case
        function spinCase() {
            const spinButton = document.getElementById('spin-button');
            const spinner = document.getElementById('spinner-wheel');
            
            spinButton.disabled = true;
            spinButton.textContent = 'SPINNING...';
            
            // Determine rarity based on case drop rates
            const rarity = determineRarity(window.currentCase.drops, window.currentCase.name);
            const skinPool = skinDatabase[rarity];
            const wonSkin = skinPool[Math.floor(Math.random() * skinPool.length)];
            
            // Track rarest pull
            const rarityOrder = ['white', 'blue', 'purple', 'pink', 'red', 'yellow', 'golden', 'black', 'event'];
            if (rarityOrder.indexOf(rarity) > rarityOrder.indexOf(gameData.rarestPull.rarity)) {
                gameData.rarestPull = { name: wonSkin.name, rarity: rarity };
            }
            
            // Add spin animation
            const spinDuration = gameData.premium ? 2000 : 3000;
            spinner.style.transition = `transform ${spinDuration}ms cubic-bezier(0.17, 0.67, 0.12, 0.99)`;
            spinner.style.transform = `rotate(${1800 + Math.random() * 360}deg)`;
            
            // Create particles for higher rarities
            if (['red', 'yellow', 'golden', 'black'].includes(rarity)) {
                createParticles();
            }
            
            setTimeout(() => {
                // Add skin to inventory
                const skinWithRarity = { ...wonSkin, rarity };
                gameData.inventory.push(skinWithRarity);
                
                // Show reward
                showReward(skinWithRarity);
                
                // Reset spinner
                spinner.style.transition = 'none';
                spinner.style.transform = 'rotate(0deg)';
                spinButton.disabled = false;
                spinButton.textContent = 'SPIN!';
                
                updateUI();
                checkQuests();
                saveGameData();
            }, spinDuration);
        }

        // Determine Rarity with Pity System
        function determineRarity(dropRates, caseName) {
            const pityCount = gameData.pityCounter[caseName] || 0;
            
            // Pity system: guaranteed rare after 50 cases
            if (pityCount >= 50) {
                gameData.pityCounter[caseName] = 0;
                const rareRarities = Object.keys(dropRates).filter(r => ['red', 'yellow', 'golden', 'black'].includes(r));
                return rareRarities[Math.floor(Math.random() * rareRarities.length)];
            }
            
            const random = Math.random();
            let cumulative = 0;
            
            // Apply luck token bonus and rank bonus
            const rank = getCurrentRank();
            const luckMultiplier = gameData.luckTokens > 0 ? 1.5 : 1;
            const rankMultiplier = rank.name === 'Bronze' ? 1 : 1 + (netWorthRanks.indexOf(rank) * 0.1);
            
            for (const [rarity, rate] of Object.entries(dropRates)) {
                const adjustedRate = rate * (rarity !== 'white' ? luckMultiplier * rankMultiplier : 1);
                cumulative += adjustedRate;
                if (random <= cumulative) {
                    // Consume luck token for rare drops
                    if (gameData.luckTokens > 0 && ['red', 'yellow', 'golden', 'black', 'event'].includes(rarity)) {
                        gameData.luckTokens--;
                    }
                    
                    // Reset pity counter on rare drop
                    if (['red', 'yellow', 'golden', 'black', 'event'].includes(rarity)) {
                        gameData.pityCounter[caseName] = 0;
                    }
                    
                    return rarity;
                }
            }
            
            return 'white'; // Fallback
        }

        // Show Reward
        function showReward(skin) {
            document.getElementById('reward-icon').className = `skin-icon rarity-${skin.rarity}`;
            document.getElementById('reward-icon').textContent = skin.icon;
            document.getElementById('reward-name').textContent = skin.name;
            document.getElementById('reward-value').textContent = `Value: $${skin.value}`;
            
            document.getElementById('spinner-modal').style.display = 'none';
            document.getElementById('reward-modal').style.display = 'block';
        }

        // Close Modals
        function closeSpinner() {
            document.getElementById('spinner-modal').style.display = 'none';
        }

        function closeReward() {
            document.getElementById('reward-modal').style.display = 'none';
        }

        // Update UI
        function updateUI() {
            document.getElementById('balance').textContent = `$${gameData.balance.toLocaleString()}`;
            document.getElementById('tokens').textContent = gameData.luckTokens;
            document.getElementById('fragments').textContent = gameData.fragments;
            
            // Calculate net worth
            const inventoryValue = gameData.inventory.reduce((sum, skin) => sum + skin.value, 0);
            const netWorth = gameData.balance + inventoryValue;
            document.getElementById('networth').textContent = `$${netWorth.toLocaleString()}`;
            
            // Update rank
            const rank = getCurrentRank();
            document.getElementById('rank').textContent = rank.name;
            document.getElementById('rank').style.color = rank.color;
            
            // Update premium status
            document.getElementById('premium-status').textContent = gameData.premium ? 'Premium' : 'Free';
            document.getElementById('premium-status').style.background = gameData.premium 
                ? 'linear-gradient(45deg, #ffd700, #ffed4e)' 
                : 'rgba(255, 255, 255, 0.2)';
        }

        // Update Inventory
        function updateInventory() {
            const inventoryGrid = document.getElementById('inventory-grid');
            inventoryGrid.innerHTML = '';
            
            gameData.inventory.forEach((skin, index) => {
                const skinItem = document.createElement('div');
                skinItem.className = 'skin-item';
                skinItem.innerHTML = `
                    <div class="skin-icon rarity-${skin.rarity}">${skin.icon}</div>
                    <div class="skin-name">${skin.name}</div>
                    <div class="skin-value">$${skin.value}</div>
                `;
                skinItem.onclick = () => sellSkin(index);
                inventoryGrid.appendChild(skinItem);
            });
        }

        // Filter Inventory
        function filterInventory(rarity) {
            // Update filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const inventoryGrid = document.getElementById('inventory-grid');
            inventoryGrid.innerHTML = '';
            
            const filteredSkins = rarity === 'all' 
                ? gameData.inventory 
                : gameData.inventory.filter(skin => skin.rarity === rarity);
            
            filteredSkins.forEach((skin, index) => {
                const skinItem = document.createElement('div');
                skinItem.className = 'skin-item';
                skinItem.innerHTML = `
                    <div class="skin-icon rarity-${skin.rarity}">${skin.icon}</div>
                    <div class="skin-name">${skin.name}</div>
                    <div class="skin-value">$${skin.value}</div>
                `;
                inventoryGrid.appendChild(skinItem);
            });
        }

        // Sell Skin
        function sellSkin(index) {
            const skin = gameData.inventory[index];
            const sellPrice = Math.floor(skin.value * 0.8); // 80% of value
            
            if (confirm(`Sell ${skin.name} for $${sellPrice}?`)) {
                gameData.balance += sellPrice;
                gameData.inventory.splice(index, 1);
                gameData.quests.marketTrades++;
                
                showNotification(`Sold ${skin.name} for $${sellPrice}!`);
                updateInventory();
                updateUI();
                checkQuests();
                saveGameData();
            }
        }

        // Generate Marketplace
        function generateMarketplace() {
            const listings = [];
            
            // Generate AI bot listings
            for (let i = 0; i < 20; i++) {
                const rarities = Object.keys(skinDatabase);
                const randomRarity = rarities[Math.floor(Math.random() * rarities.length)];
                const skinPool = skinDatabase[randomRarity];
                const randomSkin = skinPool[Math.floor(Math.random() * skinPool.length)];
                
                const markup = 1.1 + Math.random() * 0.4; // 110-150% of base value
                const price = Math.floor(randomSkin.value * markup);
                
                listings.push({
                    ...randomSkin,
                    rarity: randomRarity,
                    price: price,
                    seller: `Bot${Math.floor(Math.random() * 1000)}`
                });
            }
            
            window.marketplaceListings = listings;
        }

        // Update Marketplace
        function updateMarketplace() {
            const container = document.getElementById('marketplace-listings');
            container.innerHTML = '';
            
            window.marketplaceListings.forEach((item, index) => {
                const listingDiv = document.createElement('div');
                listingDiv.className = 'marketplace-item';
                listingDiv.innerHTML = `
                    <div class="skin-icon rarity-${item.rarity}">${item.icon}</div>
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">$${item.price}</div>
                        <small>Seller: ${item.seller}</small>
                    </div>
                    <button class="buy-btn" onclick="buyItem(${index})">Buy</button>
                `;
                container.appendChild(listingDiv);
            });
        }

        // Buy Item
        function buyItem(index) {
            const item = window.marketplaceListings[index];
            
            if (gameData.balance < item.price) {
                showNotification("Not enough balance!");
                return;
            }
            
            gameData.balance -= item.price;
            gameData.inventory.push({
                name: item.name,
                icon: item.icon,
                value: item.value,
                rarity: item.rarity
            });
            gameData.quests.marketTrades++;
            
            // Remove item from marketplace
            window.marketplaceListings.splice(index, 1);
            
            showNotification(`Bought ${item.name} for $${item.price}!`);
            updateMarketplace();
            updateUI();
            checkQuests();
            saveGameData();
        }

        // Start Battle
        function startBattle() {
            if (gameData.balance < 500) {
                showNotification("Not enough balance for battle!");
                return;
            }
            
            gameData.balance -= 500;
            
            // Generate AI opponents
            const opponents = [
                { name: "SkinHunter", avatar: "🎯", value: 0 },
                { name: "CaseKing", avatar: "👑", value: 0 },
                { name: "LootMaster", avatar: "💎", value: 0 }
            ];
            
            // Simulate battle - everyone opens the same case
            const battleCase = caseDatabase[1]; // Premium case
            let playerValue = 0;
            
            // Player opens case
            const playerRarity = determineRarity(battleCase.drops);
            const playerSkin = skinDatabase[playerRarity][Math.floor(Math.random() * skinDatabase[playerRarity].length)];
            playerValue = playerSkin.value;
            
            // Add to player inventory
            gameData.inventory.push({ ...playerSkin, rarity: playerRarity });
            
            // AI opponents open cases
            opponents.forEach(opponent => {
                const aiRarity = determineRarity(battleCase.drops);
                const aiSkin = skinDatabase[aiRarity][Math.floor(Math.random() * skinDatabase[aiRarity].length)];
                opponent.value = aiSkin.value;
                opponent.skin = aiSkin;
                opponent.rarity = aiRarity;
            });
            
            // Determine winner
            const allValues = [playerValue, ...opponents.map(o => o.value)];
            const maxValue = Math.max(...allValues);
            const isPlayerWinner = playerValue === maxValue;
            
            if (isPlayerWinner) {
                const winnings = 500 + (opponents.length * 100);
                gameData.balance += winnings;
                gameData.quests.battleWins++;
                showNotification(`🏆 Battle Won! +$${winnings}`);
            } else {
                const winner = opponents.find(o => o.value === maxValue);
                showNotification(`💔 Battle Lost! ${winner.name} won with ${winner.skin.name}`);
            }
            
            updateUI();
            checkQuests();
            saveGameData();
        }

        // Generate Quests
        function generateQuests() {
            const questList = document.getElementById('quest-list');
            questList.innerHTML = '';
            
            questTemplates.forEach(template => {
                const progress = gameData.quests[template.id] || 0;
                const isCompleted = progress >= template.target;
                
                const questDiv = document.createElement('div');
                questDiv.className = 'quest-item';
                questDiv.innerHTML = `
                    <div>
                        <div style="font-weight: bold;">${template.name}</div>
                        <div style="font-size: 14px; opacity: 0.8;">${template.description}</div>
                        <div class="quest-progress">
                            <div class="quest-progress-bar" style="width: ${Math.min(progress / template.target * 100, 100)}%;"></div>
                        </div>
                        <div style="font-size: 12px;">${progress}/${template.target}</div>
                    </div>
                    <div>
                        ${isCompleted ? 
                            `<button class="buy-btn" onclick="claimQuest('${template.id}')">Claim</button>` :
                            `<div style="color: #4ecdc4;">+${template.reward} ${template.type === 'tokens' ? 'tokens' : '$'}</div>`
                        }
                    </div>
                `;
                questList.appendChild(questDiv);
            });
        }

        // Check Quests
        function checkQuests() {
            generateQuests(); // Refresh quest display
        }

        // Claim Quest
        function claimQuest(questId) {
            const template = questTemplates.find(t => t.id === questId);
            const progress = gameData.quests[questId] || 0;
            
            if (progress >= template.target) {
                if (template.type === 'tokens') {
                    gameData.luckTokens += template.reward;
                } else {
                    gameData.balance += template.reward;
                }
                
                // Reset quest progress
                gameData.quests[questId] = 0;
                
                showNotification(`Quest completed! +${template.reward} ${template.type === 'tokens' ? 'tokens' : '$'}`);
                updateUI();
                generateQuests();
                saveGameData();
            }
        }

        // Toggle Premium
        function togglePremium() {
            gameData.premium = !gameData.premium;
            showNotification(gameData.premium ? "Premium activated!" : "Premium deactivated!");
            updateUI();
            saveGameData();
        }

        // AFK Timer
        function startAFKTimer() {
            setInterval(() => {
                if (gameData.afkTimer > 0) {
                    gameData.afkTimer--;
                    updateAFKDisplay();
                } else {
                    // Time to claim reward
                    document.getElementById('claim-afk').style.display = 'block';
                    document.getElementById('afk-timer').textContent = "Ready!";
                }
            }, 1000);
        }

        function updateAFKDisplay() {
            const minutes = Math.floor(gameData.afkTimer / 60);
            const seconds = gameData.afkTimer % 60;
            document.getElementById('afk-timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function claimAFK() {
            const reward = gameData.premium ? 2 : 1;
            gameData.balance += reward;
            gameData.afkTimer = 1800; // Reset to 30 minutes
            
            document.getElementById('claim-afk').style.display = 'none';
            showNotification(`AFK reward claimed! +$${reward}`);
            updateUI();
            saveGameData();
        }

        // Generate Leaderboard
        function generateLeaderboard() {
            const leaderboardData = [
                { rank: 1, player: "You", networth: gameData.balance + gameData.inventory.reduce((sum, skin) => sum + skin.value, 0), rarest: "Obsidian Karambit" },
                { rank: 2, player: "SkinLord", networth: 45000, rarest: "Golden Dragon" },
                { rank: 3, player: "CaseMaster", networth: 38000, rarest: "Void Emperor" },
                { rank: 4, player: "LootKing", networth: 32000, rarest: "Phoenix Wing" },
                { rank: 5, player: "SpinWizard", networth: 28000, rarest: "Midas Touch" }
            ];
            
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '';
            
            leaderboardData.forEach(entry => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#${entry.rank}</td>
                    <td>${entry.player}</td>
                    <td>$${entry.networth.toLocaleString()}</td>
                    <td>${entry.rarest}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Leave Clan
        function leaveClan() {
            if (confirm("Are you sure you want to leave Shadow Ops?")) {
                gameData.clan = null;
                showNotification("Left clan successfully!");
                document.getElementById('clan-name').textContent = "No Clan";
                saveGameData();
            }
        }

        // Create Particles
        function createParticles() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * window.innerWidth + 'px';
                    particle.style.top = Math.random() * window.innerHeight + 'px';
                    document.body.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 2000);
                }, i * 100);
            }
        }

        // Show Notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Net Worth Rank System
        function getCurrentRank() {
            const inventoryValue = gameData.inventory.reduce((sum, skin) => sum + skin.value, 0);
            const netWorth = gameData.balance + inventoryValue;
            
            for (let i = netWorthRanks.length - 1; i >= 0; i--) {
                if (netWorth >= netWorthRanks[i].threshold) {
                    return netWorthRanks[i];
                }
            }
            return netWorthRanks[0];
        }

        function updateNetWorthRank() {
            const newRank = getCurrentRank();
            if (newRank.name !== gameData.netWorthRank) {
                gameData.netWorthRank = newRank.name;
                showNotification(`🎉 Rank up! You are now ${newRank.name}!`);
            }
        }

        // Achievement System
        function generateAchievements() {
            const achievementList = document.getElementById('achievement-list');
            if (!achievementList) return;
            
            achievementList.innerHTML = '';
            
            achievements.forEach(achievement => {
                const isCompleted = checkAchievementCondition(achievement);
                const isClaimed = gameData.achievements.includes(achievement.id);
                
                const achievementDiv = document.createElement('div');
                achievementDiv.className = `achievement-item ${isCompleted && !isClaimed ? 'completed' : ''} ${isClaimed ? 'claimed' : ''}`;
                achievementDiv.innerHTML = `
                    <div>
                        <div style="font-weight: bold;">${achievement.name}</div>
                        <div style="font-size: 14px; opacity: 0.8;">${achievement.description}</div>
                        <div style="color: #4ecdc4; font-size: 12px;">Reward: ${achievement.reward} ${achievement.type === 'tokens' ? 'tokens' : '$'}</div>
                    </div>
                    <div>
                        ${isClaimed ? 
                            '<span style="color: #4ecdc4;">✓ Claimed</span>' :
                            isCompleted ? 
                                `<button class="buy-btn" onclick="claimAchievement('${achievement.id}')">Claim</button>` :
                                '<span style="opacity: 0.5;">Locked</span>'
                        }
                    </div>
                `;
                achievementList.appendChild(achievementDiv);
            });
        }

        function checkAchievementCondition(achievement) {
            switch (achievement.condition) {
                case 'casesOpened':
                    return gameData.casesOpened >= achievement.target;
                case 'totalSpent':
                    return gameData.totalSpent >= achievement.target;
                case 'battleWins':
                    return gameData.quests.battleWins >= achievement.target;
                case 'marketTrades':
                    return gameData.quests.marketTrades >= achievement.target;
                case 'networth':
                    const inventoryValue = gameData.inventory.reduce((sum, skin) => sum + skin.value, 0);
                    return (gameData.balance + inventoryValue) >= achievement.target;
                case 'rarest':
                    const rarityOrder = ['white', 'blue', 'purple', 'pink', 'red', 'yellow', 'golden', 'black', 'event'];
                    return rarityOrder.indexOf(gameData.rarestPull.rarity) >= rarityOrder.indexOf(achievement.target);
                default:
                    return false;
            }
        }

        function checkAchievements() {
            achievements.forEach(achievement => {
                if (!gameData.achievements.includes(achievement.id) && checkAchievementCondition(achievement)) {
                    showNotification(`🏆 Achievement unlocked: ${achievement.name}!`);
                }
            });
            generateAchievements();
        }

        function claimAchievement(achievementId) {
            const achievement = achievements.find(a => a.id === achievementId);
            if (!achievement || gameData.achievements.includes(achievementId)) return;
            
            if (checkAchievementCondition(achievement)) {
                if (achievement.type === 'tokens') {
                    gameData.luckTokens += achievement.reward;
                } else {
                    gameData.balance += achievement.reward;
                }
                
                gameData.achievements.push(achievementId);
                showNotification(`Achievement claimed! +${achievement.reward} ${achievement.type === 'tokens' ? 'tokens' : '$'}`);
                updateUI();
                generateAchievements();
                saveGameData();
            }
        }

        // Daily Rewards System
        function generateDailyRewards() {
            const calendar = document.getElementById('daily-calendar');
            if (!calendar) return;
            
            calendar.innerHTML = '';
            
            dailyRewards.forEach((reward, index) => {
                const day = index + 1;
                const isToday = day === gameData.dailyRewards.day;
                const isClaimed = day < gameData.dailyRewards.day || (day === gameData.dailyRewards.day && isRewardClaimedToday());
                
                const dayDiv = document.createElement('div');
                dayDiv.className = `daily-reward-day ${isClaimed ? 'claimed' : ''} ${isToday ? 'current' : ''}`;
                dayDiv.innerHTML = `
                    <div style="font-weight: bold;">Day ${day}</div>
                    <div style="font-size: 24px; margin: 10px 0;">${getRewardIcon(reward.type)}</div>
                    <div style="font-size: 14px;">${reward.reward} ${reward.type === 'tokens' ? 'Tokens' : reward.type === 'fragments' ? 'Fragments' : '$'}</div>
                `;
                calendar.appendChild(dayDiv);
            });
            
            document.getElementById('streak-count').textContent = gameData.dailyRewards.streak;
        }

        function getRewardIcon(type) {
            switch (type) {
                case 'currency': return '💰';
                case 'tokens': return '🍀';
                case 'fragments': return '💎';
                default: return '🎁';
            }
        }

        function isRewardClaimedToday() {
            const today = new Date().toDateString();
            const lastClaim = new Date(gameData.dailyRewards.lastClaim).toDateString();
            return today === lastClaim;
        }

        function checkDailyReset() {
            const now = Date.now();
            const lastClaim = gameData.dailyRewards.lastClaim;
            const oneDayMs = 24 * 60 * 60 * 1000;
            
            if (now - lastClaim > oneDayMs) {
                // Check if streak should continue or reset
                if (now - lastClaim > 2 * oneDayMs) {
                    // Missed a day, reset streak
                    gameData.dailyRewards.streak = 0;
                    gameData.dailyRewards.day = 1;
                }
            }
        }

        function claimDailyReward() {
            if (isRewardClaimedToday()) {
                showNotification("Already claimed today's reward!");
                return;
            }
            
            const currentReward = dailyRewards[gameData.dailyRewards.day - 1];
            
            switch (currentReward.type) {
                case 'currency':
                    gameData.balance += currentReward.reward;
                    break;
                case 'tokens':
                    gameData.luckTokens += currentReward.reward;
                    break;
                case 'fragments':
                    gameData.fragments += currentReward.reward;
                    break;
            }
            
            gameData.dailyRewards.lastClaim = Date.now();
            gameData.dailyRewards.streak++;
            gameData.dailyRewards.day = (gameData.dailyRewards.day % 7) + 1;
            
            showNotification(`Daily reward claimed! +${currentReward.reward} ${currentReward.type === 'tokens' ? 'tokens' : currentReward.type === 'fragments' ? 'fragments' : '$'}`);
            updateUI();
            generateDailyRewards();
            saveGameData();
        }

        // Fusion System
        let fusionSlots = [];

        function generateFusionSlots() {
            const slotsContainer = document.getElementById('fusion-slots');
            if (!slotsContainer) return;
            
            slotsContainer.innerHTML = '';
            fusionSlots = [];
            
            for (let i = 0; i < 5; i++) {
                const slot = document.createElement('div');
                slot.className = 'fusion-slot';
                slot.innerHTML = '+';
                slot.onclick = () => selectSkinForFusion(i);
                slotsContainer.appendChild(slot);
                fusionSlots.push(null);
            }
            
            updateFragmentCount();
        }

        function updateFragmentCount() {
            const fragmentElement = document.getElementById('fragment-count');
            if (fragmentElement) {
                fragmentElement.textContent = gameData.fragments;
            }
        }

        function selectSkinForFusion(slotIndex) {
            // Simple implementation - automatically fill with first available skins of same rarity
            const availableRarities = ['white', 'blue', 'purple', 'pink', 'red', 'yellow', 'golden'];
            
            for (const rarity of availableRarities) {
                const skinsOfRarity = gameData.inventory.filter(skin => skin.rarity === rarity);
                if (skinsOfRarity.length >= 5) {
                    // Fill all slots with this rarity
                    for (let i = 0; i < 5; i++) {
                        fusionSlots[i] = { ...skinsOfRarity[i], slotRarity: rarity };
                        const slotElement = document.getElementById('fusion-slots').children[i];
                        slotElement.innerHTML = skinsOfRarity[i].icon;
                        slotElement.classList.add('filled');
                    }
                    document.getElementById('fusion-btn').disabled = false;
                    return;
                }
            }
            
            showNotification("Need 5 skins of the same rarity to fuse!");
        }

        function performFusion() {
            if (fusionSlots.every(slot => slot !== null)) {
                const rarity = fusionSlots[0].slotRarity;
                const rarityOrder = ['white', 'blue', 'purple', 'pink', 'red', 'yellow', 'golden', 'black'];
                const nextRarityIndex = rarityOrder.indexOf(rarity) + 1;
                
                if (nextRarityIndex >= rarityOrder.length) {
                    showNotification("Cannot fuse higher than Golden rarity!");
                    return;
                }
                
                const nextRarity = rarityOrder[nextRarityIndex];
                
                // Remove fused skins from inventory
                fusionSlots.forEach(fusedSkin => {
                    const index = gameData.inventory.findIndex(skin => 
                        skin.name === fusedSkin.name && skin.rarity === fusedSkin.rarity
                    );
                    if (index !== -1) {
                        gameData.inventory.splice(index, 1);
                    }
                });
                
                // Add new skin
                const nextRarityPool = skinDatabase[nextRarity];
                const newSkin = nextRarityPool[Math.floor(Math.random() * nextRarityPool.length)];
                gameData.inventory.push({ ...newSkin, rarity: nextRarity });
                
                showNotification(`Fusion successful! Got ${newSkin.name}!`);
                
                // Reset fusion slots
                generateFusionSlots();
                updateUI();
                saveGameData();
            }
        }

        function convertDuplicates() {
            const skinCounts = {};
            gameData.inventory.forEach(skin => {
                const key = `${skin.name}_${skin.rarity}`;
                skinCounts[key] = (skinCounts[key] || 0) + 1;
            });
            
            let fragmentsGained = 0;
            const newInventory = [];
            
            Object.keys(skinCounts).forEach(key => {
                const count = skinCounts[key];
                const [name, rarity] = key.split('_');
                const skin = gameData.inventory.find(s => s.name === name && s.rarity === rarity);
                
                if (count > 1) {
                    // Keep one, convert others to fragments
                    newInventory.push(skin);
                    fragmentsGained += (count - 1) * Math.max(1, Math.floor(skin.value / 10));
                } else {
                    newInventory.push(skin);
                }
            });
            
            gameData.inventory = newInventory;
            gameData.fragments += fragmentsGained;
            
            if (fragmentsGained > 0) {
                showNotification(`Converted duplicates! +${fragmentsGained} fragments`);
                updateInventory();
                updateFragmentCount();
                updateUI();
                saveGameData();
            } else {
                showNotification("No duplicates found!");
            }
        }

        // Event Cases
        function checkEventCases() {
            // Remove expired event cases
            const now = Date.now();
            caseDatabase.forEach(caseData => {
                if (caseData.isEvent && now > caseData.eventEnd) {
                    // Make event skins sellable
                    gameData.inventory.forEach(skin => {
                        if (skin.event && skin.unsellable) {
                            skin.unsellable = false;
                        }
                    });
                }
            });
        }

        // Sound System
        let soundEnabled = true;

        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('sound-toggle').textContent = soundEnabled ? '🔊' : '🔇';
            showNotification(soundEnabled ? "Sound enabled" : "Sound disabled");
        }

        function playSound(type) {
            if (!soundEnabled) return;
            
            // Create audio context for sound effects
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch (type) {
                case 'spin':
                    oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(220, audioContext.currentTime + 0.5);
                    break;
                case 'rare':
                    oscillator.frequency.setValueAtTime(880, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(1100, audioContext.currentTime + 0.1);
                    break;
                case 'click':
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    break;
            }
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        // Initialize game when page loads
        window.onload = initGame;
        
        // Save game when page unloads
        window.onbeforeunload = saveGameData;
    </script>
</body>
</html>